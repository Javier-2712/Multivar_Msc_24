<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ES-es" xml:lang="ES-es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nombre del Estudiante">
<meta name="description" content="Taller integrado que combina técnicas de clasificación y pruebas de hipótesis multivariadas, orientadas a el análisis de variables morfométricas de cinco especies de peces.">

<title>Talleres 7 a 10 CLA, LDA, Manovas y Permanovas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Taller7-10.cla - permanovas.peces_files/libs/clipboard/clipboard.min.js"></script>
<script src="Taller7-10.cla - permanovas.peces_files/libs/quarto-html/quarto.js"></script>
<script src="Taller7-10.cla - permanovas.peces_files/libs/quarto-html/popper.min.js"></script>
<script src="Taller7-10.cla - permanovas.peces_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Taller7-10.cla - permanovas.peces_files/libs/quarto-html/anchor.min.js"></script>
<link href="Taller7-10.cla - permanovas.peces_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Taller7-10.cla - permanovas.peces_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Taller7-10.cla - permanovas.peces_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Taller7-10.cla - permanovas.peces_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Taller7-10.cla - permanovas.peces_files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<style>

      .quarto-title-block .quarto-title-banner {
        background: #decbe4;
      }
</style>
<link href="Taller7-10.cla - permanovas.peces_files/libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">

<script src="Taller7-10.cla - permanovas.peces_files/libs/tabwid-1.1.3/tabwid.js"></script>

<script src="Taller7-10.cla - permanovas.peces_files/libs/kePrint-0.0.1/kePrint.js"></script>

<link href="Taller7-10.cla - permanovas.peces_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">



<link rel="stylesheet" href="styles2.css">
</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Talleres 7 a 10 CLA, LDA, Manovas y Permanovas</h1>
            <p class="subtitle lead">Clasificación Multivariada (CLA y LDA) y Pruebas de Hipótesis (Manovas y Permanovas) con de Cinco especies de Peces de la India</p>
                  <div>
        <div class="description">
          Taller integrado que combina técnicas de clasificación y pruebas de hipótesis multivariadas, orientadas a el análisis de variables morfométricas de cinco especies de peces.
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Autor/a</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://www.unimagdalena.edu.co/">Nombre del Estudiante</a> </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Fecha de publicación</div>
      <div class="quarto-title-meta-contents">
        <p class="date">27 de junio de 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Menú flotante</h2>
   
  <ul>
  <li><a href="#objetivo-de-la-actividad" id="toc-objetivo-de-la-actividad" class="nav-link active" data-scroll-target="#objetivo-de-la-actividad"><strong>Objetivo de la actividad:</strong></a></li>
  <li><a href="#referencias-bibliográficas-de-apoyo." id="toc-referencias-bibliográficas-de-apoyo." class="nav-link" data-scroll-target="#referencias-bibliográficas-de-apoyo.">Referencias bibliográficas de apoyo.</a>
  <ul>
  <li><a href="#análisis-de-clúster---cla" id="toc-análisis-de-clúster---cla" class="nav-link" data-scroll-target="#análisis-de-clúster---cla">1. Análisis de Clúster - CLA</a></li>
  <li><a href="#análisis-discriminante-lineal-y-canónico--lda-y-dca" id="toc-análisis-discriminante-lineal-y-canónico--lda-y-dca" class="nav-link" data-scroll-target="#análisis-discriminante-lineal-y-canónico--lda-y-dca">2. Análisis discriminante lineal y canónico- LDA y DCA</a></li>
  <li><a href="#análisis-de-varianza-multivariado---manovas-y-permanovas" id="toc-análisis-de-varianza-multivariado---manovas-y-permanovas" class="nav-link" data-scroll-target="#análisis-de-varianza-multivariado---manovas-y-permanovas">3. Análisis de varianza multivariado - Manovas y Permanovas</a></li>
  </ul></li>
  <li><a href="#diapositivas-en-vivo" id="toc-diapositivas-en-vivo" class="nav-link" data-scroll-target="#diapositivas-en-vivo">Diapositivas en vivo</a></li>
  <li><a href="#cargar-las-librerías-requeridas" id="toc-cargar-las-librerías-requeridas" class="nav-link" data-scroll-target="#cargar-las-librerías-requeridas">Cargar las librerías requeridas</a>
  <ul>
  <li><a href="#cargar-o-importar-la-base-de-datos" id="toc-cargar-o-importar-la-base-de-datos" class="nav-link" data-scroll-target="#cargar-o-importar-la-base-de-datos">Cargar o importar la base de datos</a></li>
  <li><a href="#exploración-de-los-datos" id="toc-exploración-de-los-datos" class="nav-link" data-scroll-target="#exploración-de-los-datos">Exploración de los datos</a></li>
  </ul></li>
  <li><a href="#taller-7.-analisis-de-cluster---cla" id="toc-taller-7.-analisis-de-cluster---cla" class="nav-link" data-scroll-target="#taller-7.-analisis-de-cluster---cla">Taller 7. ANALISIS DE CLUSTER - CLA</a>
  <ul>
  <li><a href="#cuatro-pasos-para-el-análisis-de-clúster" id="toc-cuatro-pasos-para-el-análisis-de-clúster" class="nav-link" data-scroll-target="#cuatro-pasos-para-el-análisis-de-clúster">Cuatro pasos para el análisis de clúster</a></li>
  <li><a href="#paso-1.-distancia-entre-observaciones" id="toc-paso-1.-distancia-entre-observaciones" class="nav-link" data-scroll-target="#paso-1.-distancia-entre-observaciones">Paso 1. Distancia entre observaciones</a></li>
  <li><a href="#paso-2.-elección-del-método-de-agrupación-de-mayor-ajuste" id="toc-paso-2.-elección-del-método-de-agrupación-de-mayor-ajuste" class="nav-link" data-scroll-target="#paso-2.-elección-del-método-de-agrupación-de-mayor-ajuste">Paso 2. Elección del método de agrupación de mayor ajuste</a>
  <ul>
  <li><a href="#siete-métodos-de-agrupamiento" id="toc-siete-métodos-de-agrupamiento" class="nav-link" data-scroll-target="#siete-métodos-de-agrupamiento">2.1 Siete métodos de agrupamiento</a></li>
  <li><a href="#figuras-de-los-dendogramas-con-los-siete-métodos-de-agrupamiento" id="toc-figuras-de-los-dendogramas-con-los-siete-métodos-de-agrupamiento" class="nav-link" data-scroll-target="#figuras-de-los-dendogramas-con-los-siete-métodos-de-agrupamiento">2.2 Figuras de los dendogramas con los siete métodos de agrupamiento</a></li>
  <li><a href="#selección-del-mejor-método-de-agrupamiento---correlación-cofenética" id="toc-selección-del-mejor-método-de-agrupamiento---correlación-cofenética" class="nav-link" data-scroll-target="#selección-del-mejor-método-de-agrupamiento---correlación-cofenética">2.3 Selección del mejor método de agrupamiento - Correlación Cofenética</a></li>
  </ul></li>
  <li><a href="#paso-3.-número-de-grupos-formados" id="toc-paso-3.-número-de-grupos-formados" class="nav-link" data-scroll-target="#paso-3.-número-de-grupos-formados">Paso 3. Número de grupos formados</a>
  <ul>
  <li><a href="#opción-1.-niveles-de-fusión." id="toc-opción-1.-niveles-de-fusión." class="nav-link" data-scroll-target="#opción-1.-niveles-de-fusión.">Opción 1. Niveles de Fusión.</a></li>
  <li><a href="#opción-2.-número-optimo-de-clusters-de-acuerdo-al-ancho-de-silueta.-índice-de-calidad-de-rousseeuw" id="toc-opción-2.-número-optimo-de-clusters-de-acuerdo-al-ancho-de-silueta.-índice-de-calidad-de-rousseeuw" class="nav-link" data-scroll-target="#opción-2.-número-optimo-de-clusters-de-acuerdo-al-ancho-de-silueta.-índice-de-calidad-de-rousseeuw">Opción 2. Número optimo de clusters de acuerdo al Ancho de silueta. Índice de calidad de Rousseeuw</a></li>
  <li><a href="#figura-del-dendograma-jerárquico-final" id="toc-figura-del-dendograma-jerárquico-final" class="nav-link" data-scroll-target="#figura-del-dendograma-jerárquico-final">3.1 Figura del dendograma jerárquico final</a></li>
  <li><a href="#figura-del-dendograma-no-jerárquico-final" id="toc-figura-del-dendograma-no-jerárquico-final" class="nav-link" data-scroll-target="#figura-del-dendograma-no-jerárquico-final">3.2 Figura del dendograma no jerárquico final</a></li>
  </ul></li>
  <li><a href="#paso-4.-variables-de-mayor-contrinución-a-la-clasificación" id="toc-paso-4.-variables-de-mayor-contrinución-a-la-clasificación" class="nav-link" data-scroll-target="#paso-4.-variables-de-mayor-contrinución-a-la-clasificación">Paso 4. Variables de mayor contrinución a la clasificación</a></li>
  </ul></li>
  <li><a href="#taller-8.1-análisis-discriminante-lineal---lda" id="toc-taller-8.1-análisis-discriminante-lineal---lda" class="nav-link" data-scroll-target="#taller-8.1-análisis-discriminante-lineal---lda">Taller 8.1 ANÁLISIS DISCRIMINANTE LINEAL - LDA</a>
  <ul>
  <li><a href="#cargar-o-importar-la-base-de-datos-1" id="toc-cargar-o-importar-la-base-de-datos-1" class="nav-link" data-scroll-target="#cargar-o-importar-la-base-de-datos-1">Cargar o importar la base de datos</a></li>
  <li><a href="#exploración-de-los-datos-1" id="toc-exploración-de-los-datos-1" class="nav-link" data-scroll-target="#exploración-de-los-datos-1">Exploración de los datos</a></li>
  <li><a href="#mapa-de-calor" id="toc-mapa-de-calor" class="nav-link" data-scroll-target="#mapa-de-calor">Mapa de Calor</a></li>
  <li><a href="#tres-pasos-para-la-realización-del-discriminante-lineal---lda" id="toc-tres-pasos-para-la-realización-del-discriminante-lineal---lda" class="nav-link" data-scroll-target="#tres-pasos-para-la-realización-del-discriminante-lineal---lda">Tres pasos para la realización del discriminante lineal - LDA</a></li>
  <li><a href="#paso-1.-pruebas-de-supuestos" id="toc-paso-1.-pruebas-de-supuestos" class="nav-link" data-scroll-target="#paso-1.-pruebas-de-supuestos">Paso 1. Pruebas de supuestos</a>
  <ul>
  <li><a href="#supuesto-de-normalidad" id="toc-supuesto-de-normalidad" class="nav-link" data-scroll-target="#supuesto-de-normalidad">1.1 Supuesto de normalidad</a></li>
  <li><a href="#supuesto-de-homogeneidad-de-covarianzas" id="toc-supuesto-de-homogeneidad-de-covarianzas" class="nav-link" data-scroll-target="#supuesto-de-homogeneidad-de-covarianzas">1.2 Supuesto de homogeneidad de covarianzas</a></li>
  </ul></li>
  <li><a href="#paso-2.-análisis-discriminante-lineal-de-fisher---lda" id="toc-paso-2.-análisis-discriminante-lineal-de-fisher---lda" class="nav-link" data-scroll-target="#paso-2.-análisis-discriminante-lineal-de-fisher---lda">Paso 2. Análisis Discriminante Lineal de Fisher - LDA</a></li>
  <li><a href="#paso-3.-visualización-grafica-del-lda" id="toc-paso-3.-visualización-grafica-del-lda" class="nav-link" data-scroll-target="#paso-3.-visualización-grafica-del-lda">Paso 3. Visualización grafica del LDA</a></li>
  </ul></li>
  <li><a href="#taller-8.2-análisis-discriminante-canónico---dca" id="toc-taller-8.2-análisis-discriminante-canónico---dca" class="nav-link" data-scroll-target="#taller-8.2-análisis-discriminante-canónico---dca">Taller 8.2 ANÁLISIS DISCRIMINANTE CANÓNICO - DCA</a>
  <ul>
  <li><a href="#figura-del-dca" id="toc-figura-del-dca" class="nav-link" data-scroll-target="#figura-del-dca">Figura del DCA</a></li>
  </ul></li>
  <li><a href="#taller-9.-análisis-de-varianza-multivariado---manovas" id="toc-taller-9.-análisis-de-varianza-multivariado---manovas" class="nav-link" data-scroll-target="#taller-9.-análisis-de-varianza-multivariado---manovas">Taller 9. ANÁLISIS DE VARIANZA MULTIVARIADO - MANOVAS</a>
  <ul>
  <li><a href="#paso-1.-pruebas-de-supuestos-1" id="toc-paso-1.-pruebas-de-supuestos-1" class="nav-link" data-scroll-target="#paso-1.-pruebas-de-supuestos-1">Paso 1. Pruebas de supuestos</a>
  <ul>
  <li><a href="#supuesto-de-normalidad-1" id="toc-supuesto-de-normalidad-1" class="nav-link" data-scroll-target="#supuesto-de-normalidad-1">1.1 Supuesto de normalidad</a></li>
  <li><a href="#supuesto-de-homogeneidad-de-covarianzas-1" id="toc-supuesto-de-homogeneidad-de-covarianzas-1" class="nav-link" data-scroll-target="#supuesto-de-homogeneidad-de-covarianzas-1">1.2 Supuesto de homogeneidad de covarianzas</a></li>
  </ul></li>
  <li><a href="#paso-2.-análisis-de-varinaza-multivariado---manova" id="toc-paso-2.-análisis-de-varinaza-multivariado---manova" class="nav-link" data-scroll-target="#paso-2.-análisis-de-varinaza-multivariado---manova">Paso 2. Análisis de Varinaza Multivariado - MANOVA</a></li>
  <li><a href="#paso-3.-supuestos-del-manova" id="toc-paso-3.-supuestos-del-manova" class="nav-link" data-scroll-target="#paso-3.-supuestos-del-manova">Paso 3. Supuestos del MANOVA</a>
  <ul>
  <li><a href="#supuesto-de-normalidad-de-los-residuales-del-manova" id="toc-supuesto-de-normalidad-de-los-residuales-del-manova" class="nav-link" data-scroll-target="#supuesto-de-normalidad-de-los-residuales-del-manova">3.1. Supuesto de normalidad de los residuales del MANOVA</a></li>
  <li><a href="#supuesto-de-independencia" id="toc-supuesto-de-independencia" class="nav-link" data-scroll-target="#supuesto-de-independencia">3.2. Supuesto de independencia</a></li>
  </ul></li>
  <li><a href="#paso-4.-prueba-a-postriori-del-manova" id="toc-paso-4.-prueba-a-postriori-del-manova" class="nav-link" data-scroll-target="#paso-4.-prueba-a-postriori-del-manova">Paso 4. Prueba a postriori del MANOVA</a></li>
  </ul></li>
  <li><a href="#taller-10.-manovas-permutacionales---permanovas" id="toc-taller-10.-manovas-permutacionales---permanovas" class="nav-link" data-scroll-target="#taller-10.-manovas-permutacionales---permanovas">Taller 10. MANOVAS PERMUTACIONALES - PERMANOVAS</a>
  <ul>
  <li><a href="#objetivo-de-la-actividad-1" id="toc-objetivo-de-la-actividad-1" class="nav-link" data-scroll-target="#objetivo-de-la-actividad-1">Objetivo de la actividad:</a></li>
  <li><a href="#cargar-o-importar-la-base-de-datos-2" id="toc-cargar-o-importar-la-base-de-datos-2" class="nav-link" data-scroll-target="#cargar-o-importar-la-base-de-datos-2">Cargar o importar la base de datos</a></li>
  <li><a href="#exploración-de-los-datos-2" id="toc-exploración-de-los-datos-2" class="nav-link" data-scroll-target="#exploración-de-los-datos-2">Exploración de los datos</a>
  <ul>
  <li><a href="#figura-de-cajas-por-cada-variable-morfométrica" id="toc-figura-de-cajas-por-cada-variable-morfométrica" class="nav-link" data-scroll-target="#figura-de-cajas-por-cada-variable-morfométrica">Figura de <em>cajas</em> por cada variable morfométrica</a></li>
  </ul></li>
  <li><a href="#figura-del-lda-para-comparar-a-las-especies-de-peces" id="toc-figura-del-lda-para-comparar-a-las-especies-de-peces" class="nav-link" data-scroll-target="#figura-del-lda-para-comparar-a-las-especies-de-peces">Figura del <em>lda</em> para comparar a las especies de peces</a></li>
  <li><a href="#permanova-1.-análisis-de-similitudes-multivariadas---anosim" id="toc-permanova-1.-análisis-de-similitudes-multivariadas---anosim" class="nav-link" data-scroll-target="#permanova-1.-análisis-de-similitudes-multivariadas---anosim">Permanova 1. Análisis de similitudes multivariadas - ANOSIM</a>
  <ul>
  <li><a href="#paso-1.-distancia-entre-las-observaciones" id="toc-paso-1.-distancia-entre-las-observaciones" class="nav-link" data-scroll-target="#paso-1.-distancia-entre-las-observaciones">Paso 1. Distancia entre las observaciones</a></li>
  <li><a href="#paso-2.-prueba-de-hipótesis-multivariada-con-el-anosim" id="toc-paso-2.-prueba-de-hipótesis-multivariada-con-el-anosim" class="nav-link" data-scroll-target="#paso-2.-prueba-de-hipótesis-multivariada-con-el-anosim">Paso 2. Prueba de hipótesis multivariada con el ANOSIM</a></li>
  </ul></li>
  <li><a href="#permanova-2.-permutación-multirespuesta---mrpp" id="toc-permanova-2.-permutación-multirespuesta---mrpp" class="nav-link" data-scroll-target="#permanova-2.-permutación-multirespuesta---mrpp">Permanova 2. Permutación multirespuesta - MRPP</a>
  <ul>
  <li><a href="#paso-1.-distancia-entre-las-observaciones-1" id="toc-paso-1.-distancia-entre-las-observaciones-1" class="nav-link" data-scroll-target="#paso-1.-distancia-entre-las-observaciones-1">Paso 1. Distancia entre las observaciones</a></li>
  <li><a href="#paso-2.-prueba-de-hipótesis-multivariada-con-el-mrpp" id="toc-paso-2.-prueba-de-hipótesis-multivariada-con-el-mrpp" class="nav-link" data-scroll-target="#paso-2.-prueba-de-hipótesis-multivariada-con-el-mrpp">Paso 2. Prueba de hipótesis multivariada con el MRPP</a></li>
  </ul></li>
  <li><a href="#permanova-3.-permanova-de-un-factor-especies-de-peces" id="toc-permanova-3.-permanova-de-un-factor-especies-de-peces" class="nav-link" data-scroll-target="#permanova-3.-permanova-de-un-factor-especies-de-peces">Permanova 3. PERMANOVA de un factor (Especies de peces)</a>
  <ul>
  <li><a href="#paso-1.-distancia-entre-las-observaciones-2" id="toc-paso-1.-distancia-entre-las-observaciones-2" class="nav-link" data-scroll-target="#paso-1.-distancia-entre-las-observaciones-2">Paso 1. Distancia entre las observaciones</a></li>
  <li><a href="#paso-2.-prueba-de-hipótesis-multivariada-con-el-permanova" id="toc-paso-2.-prueba-de-hipótesis-multivariada-con-el-permanova" class="nav-link" data-scroll-target="#paso-2.-prueba-de-hipótesis-multivariada-con-el-permanova">Paso 2. Prueba de hipótesis multivariada con el PERMANOVA</a></li>
  <li><a href="#paso-3.-efecto-de-las-variables-morfométricas-en-la-diferenciación-de-los-grupos" id="toc-paso-3.-efecto-de-las-variables-morfométricas-en-la-diferenciación-de-los-grupos" class="nav-link" data-scroll-target="#paso-3.-efecto-de-las-variables-morfométricas-en-la-diferenciación-de-los-grupos">Paso 3. Efecto de las variables morfométricas en la diferenciación de los grupos</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">





<hr>
<section id="objetivo-de-la-actividad" class="level3">
<h3 class="anchored" data-anchor-id="objetivo-de-la-actividad"><strong>Objetivo de la actividad:</strong></h3>
<p>La base de datos que se utilizará es la de medidas morfométricas de peces de un estudio realizado con peces de la india por <strong>Gupta et al.&nbsp;(2018)</strong> <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6203374/">Articulo fuente</a> en los que se validó la taxonomía de peces de la subfamilia Barbinae, utilizando 19 variables morfométricas y 19 variables meristicas, correspondientes a 5 Especie de la familia en mención.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cdn.ncbi.nlm.nih.gov/pmc/blobs/f86e/6203374/42d415e8b3ca/pone.0206031.g002.jpg" class="img-fluid figure-img"></p>
<figcaption><n style="color:#1f78b4;"> Imágen tomada de <em>Gupta et al.&nbsp;(2018)</em> (a) <em>S . Sarana</em> (b) <em>P . ticto</em> (c) <em>P . sóforo</em> , (d) <em>P . conconio</em> y (e) <em>P . chola</em> </n></figcaption>
</figure>
</div>
<p>El <strong>objetivo</strong> de este ejercicio consiste en comparar los promedios multivariados de las variables morfométricas que caracterizan a los peces de cada especie (grupos en comparación), para conocer si los atributos morfométricos generan diferencias en cada grupo evaluado. La base de datos que se utilizará es <strong>datos.xlsx</strong>.</p>
<hr>
</section>
<section id="referencias-bibliográficas-de-apoyo." class="level3">
<h3 class="anchored" data-anchor-id="referencias-bibliográficas-de-apoyo.">Referencias bibliográficas de apoyo.</h3>
<p><a href="https://www.editdiazdesantos.com/libros/9788490524817/Rodr%C3%ADguez-Barrios-An%C3%A1lisis-de-datos-ecol%C3%B3gicos-y-ambientales-aplicaciones-con-el-programa-R.html?isbn=978849052481">Libro: Análisis de datos ecológicos y ambientales - Rodríguez-Barrios Javier 2023</a> Ver los capítulos de <strong>CLA, LDA, MANOVAS y PERMANOVAS</strong>, en donde se detallan los procedimientos descritos en el presente ejercicio.</p>
<section id="análisis-de-clúster---cla" class="level5">
<h5 class="anchored" data-anchor-id="análisis-de-clúster---cla">1. Análisis de Clúster - CLA</h5>
<ul>
<li><p><a href="https://www.editdiazdesantos.com/libros/9788490524817/Rodr%C3%ADguez-Barrios-An%C3%A1lisis-de-datos-ecol%C3%B3gicos-y-ambientales-aplicaciones-con-el-programa-R.html?isbn=978849052481">Libro: Análisis de datos ecológicos y ambientales - Rodríguez-Barrios Javier 2023</a> Se detallan todos los procedimientos descritos en el presente ejercicio.</p></li>
<li><p><a href="http://www.scielo.org.co/scielo.php?script=sci_arttext&amp;pid=S0370-39082018000400330">Microalgas de la CGSM - Vidal et al.&nbsp;(2018)</a>. Implementación de un cluster no jerárquico para valorar paleoambientes con microalgas de la Ciénaga Grande de Santa Marta.</p></li>
<li><p><a href="https://rpubs.com/kfhidalgoh/300948">Cluster</a> Brinda información complementaria para los diferentes pasos que requiere un análisis de clúster.</p></li>
<li><p><a href="https://www.cienciadedatos.net/documentos/37_clustering_y_heatmaps">Clustering y heatmaps</a> Similar al anterior enlace, brinda información detallada sobre el análisis de clúster.</p></li>
<li><p><a href="https://rquer.netlify.app/clustering/">Análisis de conglomerados</a> Otro enlace con información general sobre los clúster.</p></li>
<li><p><a href="https://rpubs.com/Joaquin_AR/310338">Clustering y heatmaps: aprendizaje no supervisado</a> Aplicación de clúster en diferentes disciplinas.</p></li>
<li><p><a href="https://uc-r.github.io/hc_clustering">Hierarchical Cluster Analysis</a> Enlace en el que se encuentra información sobre cluster jerárquicos y técnicas detalladas para seleccionar el número de k - clúster o grupos formados.</p></li>
<li><p><a href="https://www.datanovia.com/en/lessons/determining-the-optimal-number-of-clusters-3-must-know-methods/">Determining The Optimal Number Of Clusters</a> Información relevante para el paso 3 de este ejercicio, relacionado a la definición de los k-clúster o el número de grupos formados.</p></li>
<li><p><a href="https://uc-r.github.io/kmeans_clustering#optimal">K-means Cluster Analysis</a> Brinda información sobre la construcción de clúster no jerárquicos.</p></li>
</ul>
</section>
<section id="análisis-discriminante-lineal-y-canónico--lda-y-dca" class="level5">
<h5 class="anchored" data-anchor-id="análisis-discriminante-lineal-y-canónico--lda-y-dca">2. Análisis discriminante lineal y canónico- LDA y DCA</h5>
<ul>
<li><p><a href="https://www.redalyc.org/articulo.oa?id=180343692007">Sigatoka en cultivos de banano - Aguirre et al.&nbsp;(2015)</a>. Análisis de discriminante canónico y algunas técnicas multivariadas complementarias.</p></li>
<li><p><a href="https://www.r-bloggers.com/2021/05/linear-discriminant-analysis-in-r/">Linear Discriminant Analysis in R</a> Se brinda información sobre las generalidades de los lda y su aplicación en R.</p></li>
<li><p><a href="https://www.r-bloggers.com/2014/01/computing-and-visualizing-lda-in-r/">Computing and visualizing LDA in R</a> En este documento se brinda información sobre el análisis y la visualización gráfica del lda.</p></li>
</ul>
</section>
<section id="análisis-de-varianza-multivariado---manovas-y-permanovas" class="level5">
<h5 class="anchored" data-anchor-id="análisis-de-varianza-multivariado---manovas-y-permanovas">3. Análisis de varianza multivariado - Manovas y Permanovas</h5>
<ul>
<li><p><a href="https://www.r-bloggers.com/2021/11/manovamultivariate-analysis-of-variance-using-r/">MANOVA(Multivariate Analysis of Variance)</a> Este documento presenta información relevante sobre la fundamentación de los MANOVAs y su análisis en R</p></li>
<li><p><a href="https://www.r-bloggers.com/2022/05/how-to-perform-the-manova-test-in-r/?utm_source=phpList&amp;utm_medium=email&amp;utm_campaign=R-bloggers-daily&amp;utm_content=HTML">How to perform the MANOVA test in R</a> Este documento brinda información sobre los supuestos del MANOVA y la forma de realizar esta prueba multivariada en R.</p></li>
<li><p><a href="https://www.scielo.sa.cr/pdf/rbt/v59n4/a09v59n4.pdf">Perifiton de un río de Montaña - Osorio et al.&nbsp;2014</a> Valoración del proceso sucesional de microalgas perifíticas el tramo medio del río Gaira - Santa Marta.</p></li>
<li><p><a href="http://www.scielo.org.co/scielo.php?script=sci_arttext&amp;pid=S0120-548X2015000200012">Invertebrados de un río de Montaña - Rodríguez-Barrios et al.&nbsp;2011</a> Estudio de diferentes atributos comunitarios en invertebados acuáticos del río Gaira - Santa Marta.</p></li>
<li><p><a href="https://revistas.unal.edu.co/index.php/actabiol/article/view/19991/30408">Descomposición de Hojarásca en Ríos - Eyes et al.&nbsp;2011</a> Trabajo realizado en el bosque de ribera del río Gaira - Santa Marta.</p></li>
<li><p><a href="https://revistas.unal.edu.co/index.php/actabiol/article/view/19991/30408">Nutrientes de la hojarásca - Fuentes y Rodríguez. 2011</a> Otro trabajo realizado en el bosque de ribera del río Gaira - Santa Marta.</p></li>
</ul>
<hr>
</section>
</section>
<section id="diapositivas-en-vivo" class="level3">
<h3 class="anchored" data-anchor-id="diapositivas-en-vivo">Diapositivas en vivo</h3>
<p><a href="https://slides.com/d/esQwNfY/live">CLA, LDA, DCA, MANOVAS y PERMANOVAS- Peces</a></p>
<hr>
</section>
<section id="cargar-las-librerías-requeridas" class="level3">
<h3 class="anchored" data-anchor-id="cargar-las-librerías-requeridas">Cargar las librerías requeridas</h3>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librerías requeridas</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)   <span class="co"># Nueva para editar tablas </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ellipse)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(SciViews)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)       </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally) </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(gclus)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(SciViews)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(ade4)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vegan)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(stats) </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pheatmap)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"gplots"</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(candisc)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvnormtest)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"funciones.r"</span>)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Instalación de un paquete gráfico para los discriminantes (<a href="https://fawda123.github.io/ggord/">enlace</a>)</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Habilitar del repositorio</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># options(repos = c(</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   fawda123 = 'https://fawda123.r-universe.dev',</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   CRAN = 'https://cloud.r-project.org'))</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Instalación y cargue del paquete</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages('ggord')</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggord)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggord' was built under R version 4.4.3</code></pre>
</div>
</div>
<section id="cargar-o-importar-la-base-de-datos" class="level4">
<h4 class="anchored" data-anchor-id="cargar-o-importar-la-base-de-datos">Cargar o importar la base de datos</h4>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base de datos</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>peces<span class="ot">&lt;-</span><span class="fu">read_xlsx</span>(<span class="st">"datos.xlsx"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(peces,<span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-e0ba3a68{}.cl-e0b1e9c6{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e0b55de0{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e0b55dea{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e0b57910{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e0b5791a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e0b5791b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e0b57924{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e0b57925{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e0b57926{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-e0ba3a68"><thead><tr style="overflow-wrap:break-word;"><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">...1</span></p></th><th class="cl-e0b5791a"><p class="cl-e0b55dea"><span class="cl-e0b1e9c6">Especie</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">Grupo</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.1</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.2</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.3</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.4</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.5</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.6</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.7</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.8</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.9</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.10</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.11</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.12</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.13</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.14</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.15</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.16</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.17</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.18</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.19</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.20</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.21</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.22</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.23</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.24</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.25</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.26</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.27</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.28</span></p></th><th class="cl-e0b57910"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">M.29</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">1</span></p></td><td class="cl-e0b57924"><p class="cl-e0b55dea"><span class="cl-e0b1e9c6">P. chola</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">1</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.36</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.87</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.25</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.29</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.10</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.12</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.70</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.68</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.73</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.73</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">1.31</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.59</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.62</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.54</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.32</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.32</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.62</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.37</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.72</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">25</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">9</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">9</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">11</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">10</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">15</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">7</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">9</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">19</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">27</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">2</span></p></td><td class="cl-e0b57924"><p class="cl-e0b55dea"><span class="cl-e0b1e9c6">P. chola</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">1</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.39</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.88</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.27</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.26</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.11</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.12</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.70</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.65</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.73</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.77</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">1.18</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.54</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.64</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.56</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.30</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.34</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.64</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.39</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.17</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">25</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">9</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">8</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">13</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">10</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">14</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">8</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">9</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">19</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">29</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">3</span></p></td><td class="cl-e0b57924"><p class="cl-e0b55dea"><span class="cl-e0b1e9c6">P. chola</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">1</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.36</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.87</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.25</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.28</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.10</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.11</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.65</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.65</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.73</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.76</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">1.31</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.51</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.62</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.70</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.44</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.40</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.70</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.36</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.22</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">27</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">9</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">9</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">12</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">10</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">15</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">7</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">9</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">19</span></p></td><td class="cl-e0b5791b"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">27</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">4</span></p></td><td class="cl-e0b57926"><p class="cl-e0b55dea"><span class="cl-e0b1e9c6">P. chola</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">1</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.38</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.89</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.27</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.32</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.14</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.15</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.76</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.61</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.73</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.86</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">1.16</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.59</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.56</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.64</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.39</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.30</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.56</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.34</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">0.17</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">28</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">9</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">11</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">13</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">10</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">15</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">7</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">9</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">19</span></p></td><td class="cl-e0b57925"><p class="cl-e0b55de0"><span class="cl-e0b1e9c6">28</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="exploración-de-los-datos" class="level4">
<h4 class="anchored" data-anchor-id="exploración-de-los-datos">Exploración de los datos</h4>
<p>Para este ejemplo se urtilizarán figuras que relacionan a dos o más variables. En casos en los que se tengan diferentes grupos definidos, se pueden incluir figuras de cajas que permitan visualizar diferencias entre dichos grupos definidos por algún factor.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Elipses con colores con variables morfométricas</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>peces1 <span class="ot">&lt;-</span> peces[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">20</span>)]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">cor</span>(peces1)            <span class="co"># Matriz de Correlación (M)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>La <a href="#fig-fig1" class="quarto-xref">Figura&nbsp;1</a> permite visualizar las relaciones lineales entre todas las parejas de variables, incluyendo a los coeficientes de correlación de Pearson.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de elipses</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(M,  <span class="at">method =</span> <span class="st">"circle"</span>,            <span class="co"># Correlaciones con circulos</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">"lower"</span>, <span class="at">insig=</span><span class="st">"blank"</span>,    <span class="co"># Forma del panel</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">order =</span> <span class="st">"AOE"</span>, <span class="at">diag =</span> <span class="cn">FALSE</span>,      <span class="co"># Ordenar por nivel de correlación</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">addCoef.col =</span><span class="st">"black"</span>,             <span class="co"># Color de los coeficientes</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">number.cex =</span> <span class="fl">0.6</span>,                 <span class="co"># Tamaño del texto</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">COL2</span>(<span class="st">"RdYlBu"</span>, <span class="dv">200</span>))        <span class="co"># Transparencia de los circulos</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Taller7-10.cla---permanovas.peces_files/figure-html/fig-fig1-1.svg" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;1: Correlaciones y coeficientes de correlación.
</figcaption>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-fig2" class="quarto-xref">Figura&nbsp;2</a> es otra posigilidad para visualizar la relación entre las parejas de variables, pero además incluye páneles que visualizan la dispersión de los datos.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de Cajas y bigotes</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">melt</span>(peces[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">16</span>,<span class="dv">18</span>,<span class="dv">21</span>)]), <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill=</span>Especie)) <span class="sc">+</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'#fc8d59'</span>,<span class="st">'#ffffbf'</span>,<span class="st">'#99d594'</span>,<span class="st">'#377eb8'</span>,<span class="st">'#33a02c'</span>)) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,<span class="at">y=</span><span class="st">"Morfometría"</span>) <span class="sc">+</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable,<span class="at">scales=</span><span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Taller7-10.cla---permanovas.peces_files/figure-html/fig-fig2-1.svg" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2: Correlaciones, dispersión y coeficientes de correlación.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="taller-7.-analisis-de-cluster---cla" class="level2">
<h2 class="anchored" data-anchor-id="taller-7.-analisis-de-cluster---cla">Taller 7. ANALISIS DE CLUSTER - CLA</h2>
<section id="cuatro-pasos-para-el-análisis-de-clúster" class="level4">
<h4 class="anchored" data-anchor-id="cuatro-pasos-para-el-análisis-de-clúster">Cuatro pasos para el análisis de clúster</h4>
<p>A continuación se presenta el paso a paso requerido para un análisis de cluster - cla. Cabe mencionar que es un proceso algo dispendioso en tiempo, pero que brinda la posibilidad de contar con los códigos elaborados para ajustarlos de forma eficiente a otras bases de datos que requieran a este tipo de procedimientos.</p>
</section>
<section id="paso-1.-distancia-entre-observaciones" class="level4">
<h4 class="anchored" data-anchor-id="paso-1.-distancia-entre-observaciones">Paso 1. Distancia entre observaciones</h4>
<p>Son muchas las distancias que pueden emplearse, pero cada una se ajusta al tipo de datos que se requieran trabajar. Para este caso se usará la <code>distancia euclídea</code>, debido a que se ajusta de manera apropiada a datos morfométricos.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de distancia</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>d.euclid <span class="ot">&lt;-</span> <span class="fu">dist</span>(peces[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">21</span>)])</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># round(d.euclid,1)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="paso-2.-elección-del-método-de-agrupación-de-mayor-ajuste" class="level4">
<h4 class="anchored" data-anchor-id="paso-2.-elección-del-método-de-agrupación-de-mayor-ajuste">Paso 2. Elección del método de agrupación de mayor ajuste</h4>
<p>Son siete las opciones de dendogramas, de las cuales solo una será la que mejor se ajusta a los datos trabajados. Para ello, primero se realizarán los dendogramas y posteriormente se escogerá l de mejor ajuste con la <code>correlación cofenética</code>.</p>
<section id="siete-métodos-de-agrupamiento" class="level5">
<h5 class="anchored" data-anchor-id="siete-métodos-de-agrupamiento">2.1 Siete métodos de agrupamiento</h5>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 1. Vecino más cercano "Cl.single", función "hclust" y método "single"</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>Cl.single <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"single"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 2. Vecino más lejano "Cl.complete", función "complete"  </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>Cl.complete<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"complete"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 3. UPGMA función "average" Unión Promedio no Ponderado</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>Cl.upgma<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"average"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 4. UPGMC función "mcquitty" Unión Promedio Ponderado</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>Cl.upgmc<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"mcquitty"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 5. WPGMA función "centroid"</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>Cl.wpgma<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"centroid"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 6. WPGMC función "median"</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>Cl.wpgmc<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"median"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 7. WARD, función "ward"</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>Cl.ward<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"ward.D"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="figuras-de-los-dendogramas-con-los-siete-métodos-de-agrupamiento" class="level5">
<h5 class="anchored" data-anchor-id="figuras-de-los-dendogramas-con-los-siete-métodos-de-agrupamiento">2.2 Figuras de los dendogramas con los siete métodos de agrupamiento</h5>
<p>A continuación se realizará un panel que contenga hasta 4 figuras de dendogramas (<a href="#fig-fig3" class="quarto-xref">Figura&nbsp;3</a> y <a href="#fig-fig4" class="quarto-xref">Figura&nbsp;4</a>), lo cual permite resumir al número de gráficas generadas, el comando que se empleará para incluir a varias figuras en un mismo panel grafico es <code>grid.arrange()</code> del paquete <code>gridextra</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.single, <span class="at">k =</span> <span class="dv">5</span>,        <span class="co"># k grupos (opcionales)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,               <span class="co"># tamaño del texto de las ramas</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  <span class="co"># Rotulo de la distancia</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Vecino más Cercano - Single"</span>)  <span class="co"># Rotulo de título</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.complete, <span class="at">k =</span> <span class="dv">5</span>,        <span class="co"># k grupos (opcionales)</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,               <span class="co"># tamaño del texto de las ramas</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  <span class="co"># Rotulo de la distancia</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Vecino más Lejano - Complete"</span>)  <span class="co"># Rotulo de título</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.upgma, <span class="at">k =</span> <span class="dv">5</span>,           <span class="co"># k grupos (opcionales)</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,                 <span class="co"># tamaño del texto de las ramas</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  <span class="co"># Rotulo de la distancia</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Promedio no Ponderado - upgmc"</span>)  <span class="co"># Rotulo de título</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>f4 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.upgmc, <span class="at">k =</span> <span class="dv">5</span>,          </span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,                 </span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  </span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Promedio Ponderado - upgmc"</span>) </span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(f1,f2,f3,f4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Taller7-10.cla---permanovas.peces_files/figure-html/fig-fig3-1.svg" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;3: Cuatro dendogramas jerárquicos con la distancia euclídea.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>f5 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.wpgma, <span class="at">k =</span> <span class="dv">5</span>,          </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,                 </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Centroide no Ponderado - wpgma"</span>) </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>f6 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.wpgmc, <span class="at">k =</span> <span class="dv">5</span>,          </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,                 </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Centroide Ponderado - wpgmc"</span>) </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>f7 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.ward, <span class="at">k =</span> <span class="dv">5</span>,          </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,                 </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Método de Ward"</span>) </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(f5,f6,f7, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Taller7-10.cla---permanovas.peces_files/figure-html/fig-fig4-1.svg" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;4: Tres dendogramas jerárquicos restantes, con la distancia euclídea.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="selección-del-mejor-método-de-agrupamiento---correlación-cofenética" class="level5">
<h5 class="anchored" data-anchor-id="selección-del-mejor-método-de-agrupamiento---correlación-cofenética">2.3 Selección del mejor método de agrupamiento - Correlación Cofenética</h5>
<ul>
<li>2.3.1 Cálculo de las correlaciones cofenéticas</li>
</ul>
<p>El método que presente la mayor correlación cofenética será el seleccionado. Para este caso se escogerá el dendograma con el método upgma, el cuál presenta un cofenético de 0.8234.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) Correlación cofenpetica  para "single"</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>cofenet1 <span class="ot">&lt;-</span> <span class="fu">cophenetic</span>(Cl.single)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>simple <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet1)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>simple</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7035989</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (2) Correlación cofenética  para "complete"</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>cofenet2<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.complete)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>compl <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet2)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>compl</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8020806</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (3) Correlación cofenética  para "average"</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>cofenet3<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.upgma)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>upgma <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet3)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>upgma</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.811229</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (4) CCorrelación cofenética  para "mcquitty"</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>cofenet4<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.upgmc)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>upgmc <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet4)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>upgmc</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8104369</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (5) Correlación cofenética  para "centroid"</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>cofenet5<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.wpgma)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>wpgma <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet5)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>wpgma</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8091777</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (6) Correlación cofenética  para "median"</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>cofenet6<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.wpgmc)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>wpgmc <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet6)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>wpgmc</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7905545</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (7) Correlación cofenética  para "ward"</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>cofenet7<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.ward)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>ward <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet7)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>ward</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7961924</code></pre>
</div>
</div>
<ul>
<li>2.3.2 Tabulación de las correlaciones cofenéticas</li>
</ul>
<p>Los siguientes comandos permitirán organizar a los siete métodos de agrupamiento, de acuerdo a su nivel de correlación cofenética.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data frame con cofenéticos</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>cofeneticos <span class="ot">=</span> <span class="fu">data.frame</span>(simple,compl,upgma,upgmc,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                         wpgma,wpgmc,ward)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co"># cofenéticos por cada métodos (Met)</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>cofenet<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">Met =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>,<span class="at">Cofen=</span><span class="fu">t</span>(<span class="fu">round</span>(cofeneticos,<span class="dv">3</span>)))</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># tabla con orden descendente de cofenéticos</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>cof_ordenado <span class="ot">=</span> cofenet[<span class="fu">order</span>(cofenet<span class="sc">$</span>Cofen, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Impresión de la tabla con los datos</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>cof_ordenado <span class="sc">%&gt;%</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> F,<span class="at">longtable =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Met</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cofen</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">upgma</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.811</td>
</tr>
<tr class="even">
<td style="text-align: left;">upgmc</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.810</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wpgma</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.809</td>
</tr>
<tr class="even">
<td style="text-align: left;">compl</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.802</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ward</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.796</td>
</tr>
<tr class="even">
<td style="text-align: left;">wpgmc</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.791</td>
</tr>
<tr class="odd">
<td style="text-align: left;">simple</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.704</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Con este comando se puede exportar la tabla de cofenéticos como un archivo plano de <code>csv</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar tabla como csv</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv2(cof_ordenado,"cofenet.csv")</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>2.3.3 Figuras de algunas correlaciones cofenéticas vs.&nbsp;matriz de distancia</li>
</ul>
<p>A continuación se presenta una muestra de la relación entre las matrices de distancia cofenética y de distancia euclínea, que permitió seleccionar al mejor método de agrupamiento (<a href="#fig-fig9" class="quarto-xref">Figura&nbsp;9</a>).</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convertir matricesde distancia a vectores</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>d.euclid <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(d.euclid)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>d.cofenet1 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(cofenet1)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>d.cofenet2 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(cofenet2)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>d.cofenet3 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(cofenet3)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>d.cofenet4 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(cofenet4)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># crear un data frame con los vectores y agregar una columna de etiquetas</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>simple1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(d.euclid, d.cofenet1, d.cofenet2, d.cofenet3, d.cofenet4)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Impresión de la tabla con los datos</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(simple1) <span class="sc">%&gt;%</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> F,<span class="at">longtable =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">d.euclid</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">d.cofenet1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">d.cofenet2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">d.cofenet3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">d.cofenet4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.1634013</td>
<td style="text-align: right;">0.1506652</td>
<td style="text-align: right;">0.1634013</td>
<td style="text-align: right;">0.1634013</td>
<td style="text-align: right;">0.1634013</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.2525866</td>
<td style="text-align: right;">0.2471841</td>
<td style="text-align: right;">0.2647640</td>
<td style="text-align: right;">0.2783193</td>
<td style="text-align: right;">0.2916546</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.2754995</td>
<td style="text-align: right;">0.1754993</td>
<td style="text-align: right;">0.3388215</td>
<td style="text-align: right;">0.2215997</td>
<td style="text-align: right;">0.2176381</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.1664332</td>
<td style="text-align: right;">0.1506652</td>
<td style="text-align: right;">0.3388215</td>
<td style="text-align: right;">0.1879424</td>
<td style="text-align: right;">0.1919003</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.2269361</td>
<td style="text-align: right;">0.1506652</td>
<td style="text-align: right;">0.3388215</td>
<td style="text-align: right;">0.1879424</td>
<td style="text-align: right;">0.2176381</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.1506652</td>
<td style="text-align: right;">0.1506652</td>
<td style="text-align: right;">0.3388215</td>
<td style="text-align: right;">0.1879424</td>
<td style="text-align: right;">0.1919003</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figuras correlaciones cofenéticas</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) distancia cofenética  para "unión simple" </span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>f1<span class="ot">&lt;-</span><span class="fu">ggplot</span>(simple1, <span class="fu">aes</span>(d.euclid,d.cofenet1))<span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">color=</span><span class="st">"#4daf4a"</span>) <span class="sc">+</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color=</span><span class="st">"#377eb8"</span>) <span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"loess"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color =</span><span class="st">"#e41a1c"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">size=</span><span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Unión Simple"</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span> <span class="fu">paste</span>(<span class="st">"Correlación cofenética"</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="fu">cor</span>(d.euclid,cofenet1),<span class="dv">4</span>)),</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Distancia Euclidea"</span>,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Distancia cofenética"</span>) <span class="sc">+</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co"># (2) distancia cofenética  para "unión completa" </span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>f2<span class="ot">&lt;-</span><span class="fu">ggplot</span>(simple1, <span class="fu">aes</span>(d.euclid,d.cofenet2))<span class="sc">+</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">color=</span><span class="st">"#4daf4a"</span>) <span class="sc">+</span> </span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color=</span><span class="st">"#377eb8"</span>) <span class="sc">+</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"loess"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color =</span><span class="st">"#e41a1c"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">size=</span><span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Unión Completa"</span>,</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span> <span class="fu">paste</span>(<span class="st">"Correlación cofenética"</span>,</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="fu">cor</span>(d.euclid,cofenet2),<span class="dv">4</span>)),</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Distancia Euclidea"</span>,</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Distancia cofenética"</span>) <span class="sc">+</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="co"># (3) distancia cofenética  para "unión upgma" </span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>f3<span class="ot">&lt;-</span><span class="fu">ggplot</span>(simple1, <span class="fu">aes</span>(d.euclid,d.cofenet3))<span class="sc">+</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">color=</span><span class="st">"#4daf4a"</span>) <span class="sc">+</span> </span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color=</span><span class="st">"#377eb8"</span>) <span class="sc">+</span></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"loess"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color =</span><span class="st">"#e41a1c"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">size=</span><span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Unión promedio no ponderado - upgma"</span>,</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span> <span class="fu">paste</span>(<span class="st">"Correlación cofenética"</span>,</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="fu">cor</span>(d.euclid,cofenet3),<span class="dv">4</span>)),</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Distancia Euclidea"</span>,</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Distancia cofenética"</span>) <span class="sc">+</span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a><span class="co"># (4) distancia cofenética  para "unión upgmc" </span></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>f4<span class="ot">&lt;-</span><span class="fu">ggplot</span>(simple1, <span class="fu">aes</span>(d.euclid,d.cofenet4))<span class="sc">+</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">color=</span><span class="st">"#4daf4a"</span>) <span class="sc">+</span> </span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color=</span><span class="st">"#377eb8"</span>) <span class="sc">+</span></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"loess"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color =</span><span class="st">"#e41a1c"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">size=</span><span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Unión promedio ponderado - upgmc"</span>,</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span> <span class="fu">paste</span>(<span class="st">"Correlación cofenética"</span>,</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="fu">cor</span>(d.euclid,cofenet4),<span class="dv">4</span>)),</span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Distancia Euclidea"</span>,</span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Distancia cofenética"</span>) <span class="sc">+</span></span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(f1,f2,f3,f4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig5" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Taller7-10.cla---permanovas.peces_files/figure-html/fig-fig5-1.svg" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5: Cuatro regresiones entre la distancia euclídea empleada y las distancias cofenéticas de cada método de agrupamiento definido.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="paso-3.-número-de-grupos-formados" class="level4">
<h4 class="anchored" data-anchor-id="paso-3.-número-de-grupos-formados">Paso 3. Número de grupos formados</h4>
<p>La definición de los grupos formados, representan un insumo importante de información, debido a que permiten generar los k cluster en los que se agrupan las observaciones, basado en las variables que las caracterizan. Este insumo es relevante además, como paso previo a otras técnicas que requieren los grupos definidos a priori, como los análisis discriminantes lineales (lda) o los análisis de varianza multivariados (manovas), de igual forma, a partir de los grupos se pueden responder hipótesis enfocadas en las variaciones que pueden presentar las variables a lo largo de gradientes discretos o en cluster.</p>
<section id="opción-1.-niveles-de-fusión." class="level5">
<h5 class="anchored" data-anchor-id="opción-1.-niveles-de-fusión.">Opción 1. Niveles de Fusión.</h5>
<p>La figura de niveles de fusión es una de las más utilizadas para la generación de grupos o de cluster, debido a la sencillez del componente gráfico, en el cual se definen los cluster o grupos (eje Y), dependiendo del escalón de mayor amplitud o distancia horizontal (eje X). En la <a href="#fig-fig6" class="quarto-xref">Figura&nbsp;6</a> se observa que la mayor amplitud se presenta en 2 k cluster, por lo cual, el dendograma seleccionado en el paso anterior se puede clasificar en dos grupos de observaciones.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base de variables a relacionar (amb)</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>amb <span class="ot">&lt;-</span> peces[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">20</span>)]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data.frame con los datos de altura, k y número de cluster</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">h =</span> Cl.upgma<span class="sc">$</span>height, <span class="at">k =</span> <span class="fu">nrow</span>(amb)<span class="sc">:</span><span class="dv">2</span>, </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cluster =</span> <span class="fu">nrow</span>(amb)<span class="sc">:</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico de dispersión y agregar etiquetas de texto</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(f1, <span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> k, <span class="at">label =</span> cluster)) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">direction =</span> <span class="st">"vh"</span>) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Personalizar el gráfico con títulos, etiquetas de ejes y paleta de colores</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Niveles de Fusión - Distancia Euclídea - UPGMA"</span>) <span class="sc">+</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"k (Número de Cluster)"</span>) <span class="sc">+</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"h (Altura del Nodo)"</span>) <span class="sc">+</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig6" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Taller7-10.cla---permanovas.peces_files/figure-html/fig-fig6-1.svg" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6: Cuatro regresiones entre la distancia euclídea empleada y las distancias cofenéticas de cada método de agrupamiento definido.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="opción-2.-número-optimo-de-clusters-de-acuerdo-al-ancho-de-silueta.-índice-de-calidad-de-rousseeuw" class="level5">
<h5 class="anchored" data-anchor-id="opción-2.-número-optimo-de-clusters-de-acuerdo-al-ancho-de-silueta.-índice-de-calidad-de-rousseeuw">Opción 2. Número optimo de clusters de acuerdo al Ancho de silueta. Índice de calidad de Rousseeuw</h5>
<p>La amplitud de silueta es de las opciones más usadas para definir al número de k cluster o grupos del dendograma realizado. En este ejercicio también se define a dos grupos. En caso que los resultados de esta técnica sean diferentes a la anterior, se suele decidir por esta, debido a su mayor grado de precisión.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Crear un vector vacío (amb.vacio) con asw valores</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>amb.vacio <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(amb))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Silueta "sil" </span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span> (<span class="fu">nrow</span>(amb)<span class="sc">-</span><span class="dv">1</span>)){</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    sil <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(<span class="fu">cutree</span>(Cl.upgma,<span class="at">k=</span>k),d.euclid)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    amb.vacio[k]<span class="ot">&lt;-</span><span class="fu">summary</span>(sil)<span class="sc">$</span>avg.width} </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Mejor o mayor amplitud de silueta (2 particiones)</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>k.mejor <span class="ot">&lt;-</span> <span class="fu">which.max</span>(amb.vacio)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>k.mejor </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafica de silueta</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(amb),amb.vacio,<span class="at">type=</span><span class="st">"h"</span>,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Silueta-Número Óptimo de Clusters"</span>, <span class="at">xlab=</span><span class="st">"(Número de grupos)"</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Amplitud promedio de  silueta"</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>,k.mejor,<span class="fu">paste</span>(<span class="st">"optimum"</span>,k.mejor,<span class="at">sep=</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span>),<span class="at">col=</span><span class="st">"red"</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">font=</span><span class="dv">2</span>,<span class="at">col.axis=</span><span class="st">"red"</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(k.mejor,<span class="fu">max</span>(amb.vacio),<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">cex=</span><span class="fl">1.5</span>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">""</span>,<span class="st">"Silueta-Número óptimo de Clusters k="</span>,k.mejor,</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>,<span class="st">"Con una aplitud promedio de silueta"</span>,<span class="fu">max</span>(amb.vacio),<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="figura-del-dendograma-jerárquico-final" class="level5">
<h5 class="anchored" data-anchor-id="figura-del-dendograma-jerárquico-final">3.1 Figura del dendograma jerárquico final</h5>
<p>La <a href="#fig-fig7" class="quarto-xref">Figura&nbsp;7</a> muestra la manera en la que se organizan las observaciones en los dos grupos formados (ramas rojas y azules) devido a la naturaleza de las variables fisicoquímicas que las caracterizar.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dendograma final </span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_dend</span>(Cl.upgma, <span class="at">k =</span> <span class="dv">3</span>,        <span class="co"># k grupos</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.9</span>,              <span class="co"># tamaño del texto de las observaciones</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  <span class="co"># Rotulo de la distancia</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Promedio no Ponderada (UPGMA)"</span>, <span class="co"># Rotulo de título</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">lower_rect =</span> <span class="dv">0</span>,           <span class="co"># Inicio de los rectángulos en cero</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">k_colors =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>,<span class="st">"#FC4E07"</span>),</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">color_labels_by_k =</span> <span class="cn">TRUE</span>,    <span class="co"># Colores para cada grupo</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">rect =</span> <span class="cn">TRUE</span>)                 <span class="co"># Rectángulos de cada grupo</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig7" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Taller7-10.cla---permanovas.peces_files/figure-html/fig-fig7-1.svg" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7: Dendograma jerárquico final con los dos grupos asignados.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Vale la pena mencionar que estos análisis son importantes cuando se cuenta con pocas observaciones (ramas del dendograma), en el caso contrario, es preferible utilizar dendogramas no jerarquicos como el k-meas, el cual fue descrito en uno de los complementos del PCA y se retoma a continuación.</p>
</section>
<section id="figura-del-dendograma-no-jerárquico-final" class="level5">
<h5 class="anchored" data-anchor-id="figura-del-dendograma-no-jerárquico-final">3.2 Figura del dendograma no jerárquico final</h5>
<ul>
<li>Agrupamiento elegido en el paso 2 (upgma)</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de distancia</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>d.euclid <span class="ot">&lt;-</span> <span class="fu">dist</span>(amb)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 3. UPGMA función "average" Unión Promedio no Ponderado</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>Cl.upgma<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"average"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>Generación de la variable agrupadora (<strong>gr</strong>)</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable agrupadora con k=3 clúster</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>grp <span class="ot">&lt;-</span> <span class="fu">cutree</span>(Cl.upgma, <span class="at">k =</span> <span class="dv">3</span>)    <span class="co"># Grupos generados "grp"  </span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>grl <span class="ot">&lt;-</span> <span class="fu">levels</span>(<span class="fu">factor</span>(grp))        <span class="co"># Rotulos de los grupos formados</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Este es un paso opcional en caso que se requiera insertar la nueva variable agrupadora a la base de datos en revisión.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Incluir la variable agrupadora en la base de datos</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>datos<span class="fl">.1</span><span class="ot">=</span><span class="fu">data.frame</span>(grp,amb)       <span class="co"># Nuevo dataframe con la variable agrupadora (gr)</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> (datos<span class="fl">.1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  grp Grupo  M.1  M.2  M.3  M.4  M.5  M.6 M.12 M.14 M.17
1   1     1 0.36 0.87 0.25 0.29 0.10 0.12 0.59 0.54 0.62
2   1     1 0.39 0.88 0.27 0.26 0.11 0.12 0.54 0.56 0.64
3   1     1 0.36 0.87 0.25 0.28 0.10 0.11 0.51 0.70 0.70
4   1     1 0.38 0.89 0.27 0.32 0.14 0.15 0.59 0.64 0.56
5   1     1 0.39 0.88 0.27 0.31 0.12 0.14 0.58 0.56 0.64
6   1     1 0.40 0.93 0.29 0.32 0.12 0.14 0.59 0.56 0.64</code></pre>
</div>
</div>
<ul>
<li>Generación del clúster No Jerárquico (<strong>K-Means</strong>)</li>
</ul>
<p>La <a href="#fig-fig8" class="quarto-xref">Figura&nbsp;8</a> es la forma no jerárquica de presentar los resultados del cluster definido por el método de agrupamiento <code>upgma</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(<span class="fu">list</span>(<span class="at">data =</span> datos<span class="fl">.1</span>[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">cluster =</span> grp),</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#2E9FDF"</span>, <span class="st">"#FC4E07"</span>, <span class="st">"#2E9FDF"</span>),  <span class="co"># Colores para cada grupo</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">ellipse.type =</span> <span class="st">"confidence"</span>,        <span class="co"># Elipses</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">repel =</span> <span class="cn">TRUE</span>,                 <span class="co"># Elimina solapamiento de observaciones</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.clust.cent =</span> <span class="cn">FALSE</span>,      <span class="co"># Muestra a los clúster centrados</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>())     <span class="co"># Tipo de fondo tomado de ggplot2</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig8" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Taller7-10.cla---permanovas.peces_files/figure-html/fig-fig8-1.svg" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;8: Dendograma no jerárquico final con los dos grupos asignados.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Una pregunta interesante que se podría resolver, sería valorar si las diferencias entre los dos grupos de observaciones formadas es estadísticamente significativa, para lo cual se debe aplicar un análisis de varianza multivariado (manova).</p>
</section>
</section>
<section id="paso-4.-variables-de-mayor-contrinución-a-la-clasificación" class="level4">
<h4 class="anchored" data-anchor-id="paso-4.-variables-de-mayor-contrinución-a-la-clasificación">Paso 4. Variables de mayor contrinución a la clasificación</h4>
<p>A continuación se realizan diferentes opciones de <strong>mapas de calor</strong> (<a href="#fig-fig9" class="quarto-xref">Figura&nbsp;9</a>, <a href="#fig-fig10" class="quarto-xref">Figura&nbsp;10</a>), para identifiar a las variables con mayor relevancia en la clasificación realizada anteriormente en el dendograma seleccionado. Este paso es relevante cuando se quiere ponderar o seleecionar a las variables que aportan al análisis, resumiento de esta forma, la dimensionalidad del problema (número de variables).</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>amb <span class="ot">&lt;-</span> peces[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">20</span>)]</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>amb1 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(amb)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Opción 1. Mapa de calor con paquete "stats"</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>hv <span class="ot">&lt;-</span> <span class="fu">heatmap</span>(amb1, <span class="at">margins=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">6</span>), </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">distfun =</span> dist,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span><span class="st">"Variables Morfométricas"</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylab=</span> <span class="st">"Peces"</span>, </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">main =</span> <span class="st">"Clasificación de Peces"</span>,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">scale =</span> <span class="st">"row"</span>)   <span class="co"># Estandariza variables diferentes.</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig9" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Taller7-10.cla---permanovas.peces_files/figure-html/fig-fig9-1.svg" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;9: Mapa de calor que define en color rojo a las variables de mayor aporte a la clasificación realizada.
</figcaption>
</figure>
</div>
</div>
</div>
<p>El siguiente mapa de calor (<a href="#fig-fig10" class="quarto-xref">Figura&nbsp;10</a>) incorpora a la distancia euclídea utilizada y el método de agrupamiento seleccionado (upgma).</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Opción 2. Mapa de calor con paquete "stats"</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>hclust.fq <span class="ot">&lt;-</span> <span class="cf">function</span>(amb1) <span class="fu">hclust</span>(amb1, <span class="at">method=</span><span class="st">"average"</span>)   <span class="co"># Inserción de agrupación UPGMA</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(amb1,               <span class="co"># Base de datos en formato matricial</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">margins=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">7</span>),     <span class="co"># Margenes de la figura</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">scale =</span> <span class="st">"row"</span>,      <span class="co"># Estandariza variables diferentes.</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">bluered</span>(<span class="dv">100</span>),                 <span class="co"># Colores del mapa de calor</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span><span class="st">"Variables Mrfométricas"</span>,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab=</span> <span class="st">"Peces"</span>, </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Clasificación de Peces"</span>,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">trace =</span> <span class="st">"none"</span>, </span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">density.info =</span> <span class="st">"none"</span>,</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">distfun =</span> dist,          <span class="co"># Se puede usar vegdist de "vegan" </span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">hclustfun=</span>hclust.fq)     <span class="co"># Agrupamiento UPGMA</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig10" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Taller7-10.cla---permanovas.peces_files/figure-html/fig-fig10-1.svg" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;10: Mapa de calor que define en color rojo a las variables de mayor aporte a la clasificación realizada.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="taller-8.1-análisis-discriminante-lineal---lda" class="level2">
<h2 class="anchored" data-anchor-id="taller-8.1-análisis-discriminante-lineal---lda">Taller 8.1 ANÁLISIS DISCRIMINANTE LINEAL - LDA</h2>
<p><strong>Objetivo de la actividad:</strong></p>
<p>La base de datos que se utilizará es la de medidas morfométricas de peces de un estudio realizado con peces de la india por <strong>Gupta et al.&nbsp;(2018)</strong> <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6203374/">Articulo fuente</a> en los que se validó la taxonomía de peces de la subfamilia Barbinae, utilizando 19 variables morfométricas y 19 variables meristicas, correspondientes a 5 Especie de la familia en mención.</p>
<hr>
<section id="cargar-o-importar-la-base-de-datos-1" class="level4">
<h4 class="anchored" data-anchor-id="cargar-o-importar-la-base-de-datos-1">Cargar o importar la base de datos</h4>
<p>La presente base de datos se encuentra en formato plano de <code>csv</code>, presenta una columna <code>Especie</code> que agrupa a las 5 Especie de peces, otra columna <code>Grupo</code>, que asigna un número a cada especie y posteriormente a las 19 variables morfométricas y 10 variables meristicas, de las cuales se selecionarán las 19 morfométricas para este ejercicio <code>M.1</code> a <code>M.19</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base de datos</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>peces<span class="ot">&lt;-</span><span class="fu">read_xlsx</span>(<span class="st">"datos.xlsx"</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># names(peces)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exploración-de-los-datos-1" class="level4">
<h4 class="anchored" data-anchor-id="exploración-de-los-datos-1">Exploración de los datos</h4>
<p>La <a href="#fig-fig11" class="quarto-xref">Figura&nbsp;11</a> permite visualizar la resolución de cada variable para diferenciar o discriminar a las diferentes especies de peces. Esta figura sirve de insumo para descartar aquellas variables con poco potencial de discriminación de las especies.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figuras multivariadas de Cajas y bigotes</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">melt</span>(peces[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">16</span>,<span class="dv">18</span>,<span class="dv">21</span>)]), <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill=</span>Especie)) <span class="sc">+</span> </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'#fc8d59'</span>,<span class="st">'#ffffbf'</span>,<span class="st">'#99d594'</span>,<span class="st">'#377eb8'</span>,<span class="st">'#33a02c'</span>)) <span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,<span class="at">y=</span><span class="st">"Morfometría"</span>) <span class="sc">+</span> </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable,<span class="at">scales=</span><span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig11" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig11-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Taller7-10.cla---permanovas.peces_files/figure-html/fig-fig11-1.svg" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig11-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;11: Variación en la morfometría de los peces, de acuerdo a cada una de las variables seleccionadas.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="mapa-de-calor" class="level4">
<h4 class="anchored" data-anchor-id="mapa-de-calor">Mapa de Calor</h4>
<p>El siguiente mapa de calor también permite visualizar a la resolución de las variables morfométricas para diferenciar a las especies de peces, las cuales representan a los grupos en comparación. Con los siguientes comandos se calculará una tabla que resume a los <code>promedios</code> de las 10 variables morfométricas para cada especie evaluada.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracción de los promedios de las variables para cada especie</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>promedios <span class="ot">&lt;-</span> peces <span class="sc">%&gt;%</span>      </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Especie"</span>,<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,<span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Especie) <span class="sc">%&gt;%</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), mean))</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>promedios  <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(promedios) <span class="co"># Guardar promedios como dataframe</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co"># promedios</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>A continuación se combierte el dataframe a formato matricial - <code>promedios2</code>, para poder ser graficado en el mapa de calor.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionar columnas de 2 a 10 del data frame peces1 y convertirlas en matriz</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>promedios2 <span class="ot">&lt;-</span> promedios <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">11</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">as.matrix</span>()</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(promedios2,<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   M.1  M.2  M.3  M.4  M.5  M.6  M.7 M.13 M.15 M.18
1 0.38 0.87 0.27 0.30 0.11 0.12 0.69 0.59 0.35 0.35
2 0.32 0.76 0.25 0.25 0.11 0.13 0.66 0.52 0.34 0.33
3 0.36 0.85 0.26 0.29 0.11 0.13 0.68 0.56 0.29 0.31
4 0.37 0.90 0.26 0.28 0.13 0.15 0.70 0.45 0.39 0.40
5 0.48 0.76 0.28 0.31 0.13 0.16 0.88 0.62 0.28 0.18</code></pre>
</div>
</div>
<p>Ahora se incluyen los nombres de las especies a la matriz <code>promedios2</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Asignar los valores de la primera columna de peces1 como nombres de fila en la matriz peces2</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(promedios2) <span class="ot">&lt;-</span> promedios[,<span class="dv">1</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>La <a href="#fig-fig12" class="quarto-xref">Figura&nbsp;12</a> incorpora elementos adicionales como al método de agrupamiento <code>upgma</code>, asumiendo que puede ser el que mejor se ajusta a los datos de este ejercicio.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Opción 2. Mapa de calor con paquete "stats"</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>hclust.fq <span class="ot">&lt;-</span> <span class="cf">function</span>(promedios2) </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">hclust</span>(promedios2, <span class="at">method=</span><span class="st">"average"</span>)   <span class="co"># Inserción de UPGMA</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(promedios2,         <span class="co"># Base de datos en formato matricial</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">margins=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">12</span>),    <span class="co"># Margenes de la figura</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">scale =</span> <span class="st">"row"</span>,      <span class="co"># Estandariza variables diferentes.</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">bluered</span>(<span class="dv">100</span>),                 <span class="co"># Colores del mapa de calor</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span><span class="st">"Variables morfométricas"</span>, </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab=</span> <span class="st">"Especie de Peces"</span>, </span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Clasificación de Peces"</span>,   </span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">trace =</span> <span class="st">"none"</span>, </span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">density.info =</span> <span class="st">"none"</span>,</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">distfun =</span> dist,          <span class="co"># Se puede usar vegdist de "vegan" </span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">hclustfun=</span>hclust.fq)     <span class="co"># Agrupamiento UPGMA</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig12" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Taller7-10.cla---permanovas.peces_files/figure-html/fig-fig12-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;12: Mapa de calor que relaciona a las variables morfométricas y a las especies de peces.
</figcaption>
</figure>
</div>
</div>
</div>
<p>División de los datos en conjuntos de entrenamiento y prueba: Se recomienda estandarizar o normalizar las variables predictoras (morfométricas) para que no haya un efecto de la escala. Algunos autores recomiendan dividir los datos de entrenamiento en un 60% y los datos de la prueba en 40% (<a href="https://finnstats.com/2021/05/02/linear-discriminant-analysis/">FINNSTATS</a>) o datos de entrenamiento en un 80% y los de prueba en un 20%. (<a href="http://www.sthda.com/english/articles/36-classification-methods-essentials/146-discriminant-analysis-essentials-in-r/">STHDA</a>). Se utilizará la segunda propuesta para este ejercicio.</p>
<p><strong>1.&nbsp;División de los datos en conjuntos de entrenamiento y prueba</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # Dividir los datos en entrenamiento (80%) y conjunto de prueba (20%)</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>muestra.entrenamiento <span class="ot">&lt;-</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  peces<span class="sc">$</span>Especie <span class="sc">%&gt;%</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">createDataPartition</span>(<span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>entrenamiento <span class="ot">&lt;-</span> peces[muestra.entrenamiento, ]</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>prueba <span class="ot">&lt;-</span> peces[<span class="sc">-</span>muestra.entrenamiento, ] </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>2. Normalizar los datos. Las variables categóricas (Especie) se ignoran automáticamente.</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimar los parámetros de preprocesamiento</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>preprocesamiento <span class="ot">&lt;-</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  entrenamiento <span class="sc">%&gt;%</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">preProcess</span>(<span class="at">method =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>))</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformar los datos usando los parámetros estimados.</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>entrenam.transf <span class="ot">&lt;-</span> </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  preprocesamiento <span class="sc">%&gt;%</span> </span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(entrenamiento)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>prueba.transf <span class="ot">&lt;-</span> </span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  preprocesamiento <span class="sc">%&gt;%</span> </span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(prueba)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tres-pasos-para-la-realización-del-discriminante-lineal---lda" class="level4">
<h4 class="anchored" data-anchor-id="tres-pasos-para-la-realización-del-discriminante-lineal---lda">Tres pasos para la realización del discriminante lineal - LDA</h4>
</section>
<section id="paso-1.-pruebas-de-supuestos" class="level4">
<h4 class="anchored" data-anchor-id="paso-1.-pruebas-de-supuestos">Paso 1. Pruebas de supuestos</h4>
<p>Para que el análisis discriminante lineal sea considerado como un modelo lineal, debe cumplir con los supuestos de normalidad multivariada y de homogeneidad de covarianzas. Para el caso del presente ejercicio, dichos supuestos no alcanzan a cumplirse con los diagnosticos utilizados (valor p &lt; 0.05), motivo por el cual, el lda de este ejercicio será tomado como una técnica de exploración moltivariada para saber que tan bien discriminados quedan los individuos de cada especie, basado en las 10 variables morfomètricas seleccionadas.</p>
<section id="supuesto-de-normalidad" class="level5">
<h5 class="anchored" data-anchor-id="supuesto-de-normalidad">1.1 Supuesto de normalidad</h5>
<p>El supuesto de normalidad multivariada será evaluado con el paquete <code>mvnormtest</code>, el cual utiliza el estadìstico de <code>Shapiro Wilks Multivariado</code>. Para ello se realizarà esta prueba en cada uno de los grupos o especies en comparación.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnóstico de normalidad por cada tipo de Especie</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvnormtest)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Los siguientes generan los dataframes de cada especie con las 10 variables seleccionadas, convirtiendola ademàs en formato matricial.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataframe por cada especie</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. datos de P. chola.</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>P.chola   <span class="ot">&lt;-</span> entrenam.transf <span class="sc">%&gt;%</span> </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Especie <span class="sc">==</span> <span class="st">"P. chola"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span>              </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">as.matrix</span>()</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. datos de P. conchonious.</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>P.concho  <span class="ot">&lt;-</span> entrenam.transf <span class="sc">%&gt;%</span> </span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Especie <span class="sc">==</span> <span class="st">"P. conchonious"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>             <span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span>              </span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>             <span class="fu">as.matrix</span>() </span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. datos de P. sophore.</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>P.sophore <span class="ot">&lt;-</span> entrenam.transf <span class="sc">%&gt;%</span> </span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Especie <span class="sc">==</span> <span class="st">"P. sophore"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span>              </span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">as.matrix</span>()     </span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. datos de P. ticto.</span></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>P.ticto   <span class="ot">&lt;-</span> entrenam.transf <span class="sc">%&gt;%</span> </span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Especie <span class="sc">==</span> <span class="st">"P. ticto"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span>              </span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">as.matrix</span>()       </span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. datos de P. ticto.</span></span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>S.sarana  <span class="ot">&lt;-</span> entrenam.transf <span class="sc">%&gt;%</span> </span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Especie <span class="sc">==</span> <span class="st">"S. sarana"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,</span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span>              </span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">as.matrix</span>() </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Vale la pena resaltar que los datos de las especies P. chola y P. sophore, son singulares, por lo cual no puede calcularse su supuesto de normalidad multivariada. Con el objeto de continuar en el ejercicio, las matrices que representan a las especies en menciòn, seràn desactivadas con <code>#</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prueba de normalidad para cada especie</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>norm1 <span class="ot">&lt;-</span> <span class="fu">mshapiro.test</span>(<span class="fu">t</span>(P.chola))   <span class="co"># Matriz singular</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co">#norm2   &lt;- mshapiro.test(t(P.concho))</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co">#norm3 &lt;- mshapiro.test(t(P.sophore)) # Matriz singular</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>norm4   <span class="ot">&lt;-</span> <span class="fu">mshapiro.test</span>(<span class="fu">t</span>(P.ticto))</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>norm5   <span class="ot">&lt;-</span> <span class="fu">mshapiro.test</span>(<span class="fu">t</span>(S.sarana))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Otra opción de normalidad</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. datos de P. chola.</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co">#P.chola   &lt;- entrenam.transf %&gt;% </span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co">#             filter(Especie == "P. chola") %&gt;%       </span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co">#             subset(select = c("M.1","M.2","M.3","M.4","M.5",</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                               "M.6","M.7","M.13","M.15","M.18")) %&gt;%</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  as.data.frame()</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co">#norm1 &lt;- mardia(P.chola)</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co">#norm1 %&gt;% </span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="co">#flextable()</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>A continuación se resume el resultado de los tres diagnósticos de normalidad multivariada realizados. Vale la pena mencionar que ninguna especie cumple con dicho supuesto estadóstico (valores p &lt; 0.05), aunque existe la posibilidad de probar con alguna transformación.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen de el diagnóstico de normalidad</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">normalidad =</span> <span class="fu">data.frame</span>(<span class="at">Norm.chola  =</span> norm1<span class="sc">$</span>p.value,</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Norm.ticto  =</span> norm4<span class="sc">$</span>p.value,</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Norm.sarana =</span> norm5<span class="sc">$</span>p.value))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Norm.chola   Norm.ticto  Norm.sarana
1 0.01189882 1.091453e-07 1.969691e-06</code></pre>
</div>
</div>
</section>
<section id="supuesto-de-homogeneidad-de-covarianzas" class="level5">
<h5 class="anchored" data-anchor-id="supuesto-de-homogeneidad-de-covarianzas">1.2 Supuesto de homogeneidad de covarianzas</h5>
<p>La prueba de homogeneidad de covarianza o <strong>esfericidad</strong>, corresponde al segundo supuesto del análisis discriminante lineal, se utilizará la función <code>betadisper</code>, la cual es complementada por dos análisis de varianza, los cuales definirán si el supuesto logra ser cumplido.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pruebas de Homogeneidad de covarianzas paquete "vegan"</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>peces.d <span class="ot">&lt;-</span> <span class="fu">dist</span>(entrenam.transf[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">20</span>)])   <span class="co"># Matriz de distancias</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>peces.homoge <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(peces.d, entrenam.transf<span class="sc">$</span>Especie) <span class="co"># Permutest</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Con la siguiente <code>anova</code> se obtiene un valor p de 0.27, lo cual indica que si se cumple el supuesto de homogeneidad de covarianzas (valor p &gt; 0.05).</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Prueba con anova permutacional</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(peces.homoge)  </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Distances
          Df  Sum Sq Mean Sq F value Pr(&gt;F)
Groups     4  1.1817 0.29543   0.605 0.6607
Residuals 53 25.8808 0.48832               </code></pre>
</div>
</div>
<p>Con el <code>permutest</code> se obtiene un valor p de 0.28*, lo cual indica que también se cumple el supuesto de homogeneidad de covarianzas (valor p &gt; 0.05).</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Prueba permutacional</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(peces.homoge)   <span class="co"># Se cumple el supuesto de homogeneidad </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 999

Response: Distances
          Df  Sum Sq Mean Sq     F N.Perm Pr(&gt;F)
Groups     4  1.1817 0.29543 0.605    999  0.669
Residuals 53 25.8808 0.48832                    </code></pre>
</div>
</div>
</section>
</section>
<section id="paso-2.-análisis-discriminante-lineal-de-fisher---lda" class="level4">
<h4 class="anchored" data-anchor-id="paso-2.-análisis-discriminante-lineal-de-fisher---lda">Paso 2. Análisis Discriminante Lineal de Fisher - LDA</h4>
<p>A continuación, se realizará el lda, que permitirá generar definir al nivel de discriminación de cada grupo o especie de pez. Se presentan algunas opciones gráficas con el procedimiento general y con el análisis discriminate canónico (dca)</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo del LDA</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># names(entrenam.transf)</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Modelo Discriminante Lineal (lda)</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>dis<span class="ot">&lt;-</span><span class="fu">lda</span> (Especie <span class="sc">~</span> M<span class="fl">.1</span><span class="sc">+</span>M<span class="fl">.2</span><span class="sc">+</span>M<span class="fl">.3</span><span class="sc">+</span>M<span class="fl">.4</span><span class="sc">+</span>M<span class="fl">.5</span><span class="sc">+</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>                    M<span class="fl">.6</span><span class="sc">+</span>M<span class="fl">.7</span><span class="sc">+</span>M<span class="fl">.13</span><span class="sc">+</span>M<span class="fl">.15</span><span class="sc">+</span>M<span class="fl">.18</span>,</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> entrenam.transf)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(dis<span class="sc">$</span>prior,<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      P. chola P. conchonious     P. sophore       P. ticto      S. sarana 
          0.17           0.12           0.09           0.28           0.34 </code></pre>
</div>
</div>
<p>“<em>Prior probabilities of groups</em>” corresponde a la probabilidad de clasificación para cada grupo que dependerá del número de peces que lo conforman, aqueyas especies con mayor número de individuos censados, presentarán mayor probabilidad de discriminación.</p>
<p>Prbabilidad de clasificar indv. de los cinco grupos: P. chola P. conchonious P. sophore P. ticto S. sarana 0.17 0.11 0.08 0.28 0.34</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Insumos del AD </span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(dis)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>A continuación se presentan los promedios de cada especie por cada variable morfométrica seleccionada para el análisis.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Grupos de medias para las 4 variables </span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(dis<span class="sc">$</span>means,<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 M.1   M.2   M.3   M.4   M.5   M.6   M.7  M.13  M.15  M.18
P. chola       -0.35  0.63  0.00  0.09 -0.87 -1.04 -0.60  0.51  0.38  0.41
P. conchonious -1.46 -0.81 -1.22 -1.60 -0.97 -1.06 -0.96 -0.37 -0.14  0.32
P. sophore     -0.45  0.38 -0.23  0.35 -0.39 -0.33 -0.83  0.06 -0.78  0.14
P. ticto       -0.51  0.97 -0.42 -0.45  0.55  0.44 -0.51 -1.19  1.01  0.86
S. sarana       1.21 -0.90  0.82  0.79  0.43  0.62  1.25  0.81 -0.76 -1.04</code></pre>
</div>
</div>
<p>Los autovalores son los que permiten definir las coordenadas de las variables para cada función canónica (eje o dimensión del lda), para la grafica del discriminante, se utilizarán las funciones <code>LD1</code> y <code>LD2</code>, como ejes <code>x</code> y <code>y</code> respectivamente (ver <a href="#fig-fig13" class="quarto-xref">Figura&nbsp;13</a>).</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Autovalores estandarizados (pesos de las variables en cada eje)</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>((Cs <span class="ot">&lt;-</span> dis<span class="sc">$</span>scaling),<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       LD1   LD2   LD3   LD4
M.1   2.44 -1.49  1.27  0.01
M.2  -1.23  0.59  0.92 -0.41
M.3  -0.09 -0.09  0.34  0.51
M.4   0.46  1.49  0.81 -0.37
M.5  -0.19 -0.02 -0.40  0.36
M.6  -0.28 -1.21 -0.30 -1.12
M.7   0.53 -0.77 -0.44  0.70
M.13  0.66  1.34 -0.30  0.11
M.15 -0.33 -0.56  0.53  1.07
M.18 -0.33 -0.73  0.17  0.10</code></pre>
</div>
</div>
<p>En el siguiente insumo se relacionan las coordenadas de las 6 primeras observaciones, las cuales también serán graficadas en la <a href="#fig-fig13" class="quarto-xref">Figura&nbsp;13</a>.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coordenadas de las seis primeras observaciones en cada eje canónico</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">head</span>(Fp <span class="ot">&lt;-</span> <span class="fu">predict</span>(dis)<span class="sc">$</span>x),<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    LD1  LD2  LD3   LD4
1 -0.97 2.21 0.00  0.61
2 -2.55 3.45 1.59  2.68
3 -2.08 1.49 1.26  0.85
4 -1.44 2.49 1.64 -0.50
5 -1.44 3.07 2.85 -0.22
6 -0.10 4.56 1.19  0.68</code></pre>
</div>
</div>
<p>La siguiente tabla es conocida como <strong>tabla de contingencia</strong> la cual realiza una validación cruzada entre las especies (filas) y los grupos discriminados por el lda (columnas). De acuerdo a esta tabla solo <em>P. sophore</em> no discrimina a todos sus individuos en su grupo, debido a que hay dos peces que presentan una morfometría más similar a <em>P. chola</em>.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluación de desempeño del AD (método 1)</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(entrenam.transf)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>group<span class="ot">&lt;-</span><span class="fu">predict</span>(dis,<span class="at">method=</span><span class="st">"plug-in"</span>)<span class="sc">$</span>class</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>(tabla<span class="ot">&lt;-</span><span class="fu">table</span>(Especie,group))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                group
Especie          P. chola P. conchonious P. sophore P. ticto S. sarana
  P. chola             10              0          0        0         0
  P. conchonious        0              7          0        0         0
  P. sophore            1              0          4        0         0
  P. ticto              0              0          0       16         0
  S. sarana             0              0          0        0        20</code></pre>
</div>
</div>
<p>La siguiente tabla realiza una validación en términos porcentuales, definiendo que en el caso de <em>P. sophore</em> el 64% de sus individuos discriminan correctamente en su especie. El resto de especies presentan una discriminación completa en su grupo.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Porcentaje de clasificación correcta </span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">diag</span>(<span class="fu">prop.table</span>(tabla, <span class="dv">1</span>)),<span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      P. chola P. conchonious     P. sophore       P. ticto      S. sarana 
           100            100             80            100            100 </code></pre>
</div>
</div>
<p>La siguiente validación realizada por el método de Jacknife, presenta menos resolución de discriminación que la anterior, por lo cual no será tenida en cuenta en este ejercicio.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># M?todo 2: con clasifiación basada en jacknife (validación cruzada dejando uno afuera)</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>dis.jac <span class="ot">&lt;-</span> <span class="fu">lda</span>(Especie <span class="sc">~</span> M<span class="fl">.1</span><span class="sc">+</span>M<span class="fl">.2</span><span class="sc">+</span>M<span class="fl">.3</span><span class="sc">+</span>M<span class="fl">.4</span><span class="sc">+</span>M<span class="fl">.5</span><span class="sc">+</span>M<span class="fl">.6</span><span class="sc">+</span>M<span class="fl">.7</span><span class="sc">+</span>M<span class="fl">.13</span><span class="sc">+</span>M<span class="fl">.15</span><span class="sc">+</span>M<span class="fl">.18</span>,</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>entrenam.transf, <span class="at">CV=</span><span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Número y proporciones de clasificación correcta</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>clases.jac <span class="ot">&lt;-</span> dis.jac<span class="sc">$</span>class</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>tabla.jac <span class="ot">&lt;-</span> <span class="fu">table</span>(Especie, clases.jac)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>tabla.jac</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                clases.jac
Especie          P. chola P. conchonious P. sophore P. ticto S. sarana
  P. chola              9              0          1        0         0
  P. conchonious        0              7          0        0         0
  P. sophore            3              0          2        0         0
  P. ticto              0              0          0       16         0
  S. sarana             0              0          0        0        20</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Validación cruzada</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">diag</span>(<span class="fu">prop.table</span>(tabla.jac, <span class="dv">1</span>)),<span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      P. chola P. conchonious     P. sophore       P. ticto      S. sarana 
            90            100             40            100            100 </code></pre>
</div>
</div>
</section>
<section id="paso-3.-visualización-grafica-del-lda" class="level4">
<h4 class="anchored" data-anchor-id="paso-3.-visualización-grafica-del-lda">Paso 3. Visualización grafica del LDA</h4>
<ul>
<li>** 3.1 Gráfico de elipses.**</li>
</ul>
<p>A continuación se realizará el componente grafico del lda, el cual inicia con una figura que definirá unas elipses, las cuales relacionan a los individuos de cada especie y cuyo solapamiento definirá el nivel de relación entre estas.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Escores o coordenadas de las observaciones en cada eje can?nico</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>Fp <span class="ot">&lt;-</span> <span class="fu">predict</span>(dis)<span class="sc">$</span>x</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grupos asignados por el AD</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>group<span class="ot">&lt;-</span><span class="fu">predict</span>(dis,<span class="at">method=</span><span class="st">"plug-in"</span>)<span class="sc">$</span>class</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coordenadas y grupos asignados</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>peces.coord<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">Especie=</span>group,Fp)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>La <a href="#fig-fig13" class="quarto-xref">Figura&nbsp;13</a> demuestra que si bien de presenta una buena discriminación de las especies de peces, 4 de las 5 evaluadas presentan cierta relación, definida por el solapamiento de sus elipses.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura del LDA</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(entrenam.transf)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplot</span>(LD2<span class="sc">~</span>LD1 <span class="sc">|</span> Especie, <span class="at">data=</span>peces.coord,<span class="at">reg.line=</span><span class="cn">FALSE</span>, </span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">smooth=</span>F, <span class="at">spread=</span>F,<span class="at">span=</span> <span class="dv">1</span>,<span class="at">grid=</span>F,</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend=</span><span class="fu">list</span>(<span class="at">coords=</span><span class="st">"bottom"</span>), </span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">ellipse=</span>T,<span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">19</span>),</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">col=</span><span class="fu">c</span>(<span class="st">'#fc8d59'</span>,<span class="st">'#e41a1c'</span>,<span class="st">'#984ea3'</span>,<span class="st">'#377eb8'</span>,<span class="st">'#33a02c'</span>),</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">main=</span><span class="st">"Análisis discriminante"</span>,</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">font.main=</span><span class="dv">2</span>,<span class="at">cex.main=</span><span class="dv">2</span>,<span class="at">cex.lab=</span><span class="fl">1.5</span>,</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab=</span><span class="st">"Eje1"</span>, <span class="at">ylab=</span><span class="st">"Eje2"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig13" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Taller7-10.cla---permanovas.peces_files/figure-html/fig-fig13-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;13: Mapa de calor que relaciona a las variables morfométricas y a las especies de peces.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura 2 del LDA</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Escores o coordenadas de las observaciones en cada eje can?nico</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>Fp <span class="ot">&lt;-</span> <span class="fu">predict</span>(dis)<span class="sc">$</span>x</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>lda <span class="ot">&lt;-</span> <span class="fu">cbind</span>(entrenam.transf, Fp)</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lda, <span class="fu">aes</span>(LD1, LD2)) <span class="sc">+</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Especie), <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid=</span><span class="fu">element_blank</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller7-10.cla---permanovas.peces_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura 3 del LDA</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggord</span>(dis, entrenam.transf<span class="sc">$</span>Especie) <span class="sc">+</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="dv">3</span>,<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="dv">3</span>,<span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">panel.grid=</span><span class="fu">element_blank</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller7-10.cla---permanovas.peces_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coordenadas de los sitios</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>Fp <span class="ot">&lt;-</span> <span class="fu">predict</span>(dis)<span class="sc">$</span>x</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Grupos </span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>group<span class="ot">&lt;-</span><span class="fu">predict</span>(dis,<span class="at">method=</span><span class="st">"plug-in"</span>)<span class="sc">$</span>class</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Coordenadas de los sitios y el factor (coord.sit)</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataframe</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>coord.sit <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predict</span>(dis)<span class="sc">$</span>x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])     <span class="co"># Coordenadas de los sitios</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>coord.sit<span class="sc">$</span>sitio <span class="ot">&lt;-</span> <span class="fu">rownames</span>(coord.sit)               <span class="co"># Crear una columna con nombres de los sitios</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>coord.sit<span class="sc">$</span>grp <span class="ot">&lt;-</span> group                               <span class="co"># Adicionar columna de grupos por Tributario</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(coord.sit)                                      <span class="co"># vista resumida de las coordenadas de sitios</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         LD1      LD2 sitio      grp
1 -0.9746434 2.212049     1 P. chola
2 -2.5524750 3.445299     2 P. chola
3 -2.0820106 1.492841     3 P. chola
4 -1.4445957 2.490105     4 P. chola
5 -1.4360728 3.073528     5 P. chola
6 -0.1018922 4.563710     6 P. chola</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Coordenadasde las variables (coord.var) </span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>coord.var <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">round</span>((Cs <span class="ot">&lt;-</span> dis<span class="sc">$</span>scaling),<span class="dv">2</span>)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])    <span class="co"># Dos primeros ejes</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">rownames</span>(coord.var)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>coord.var <span class="ot">&lt;-</span> <span class="fu">cbind</span>(coord.var, <span class="at">variables =</span> variables)</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(coord.var)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      LD1   LD2 variables
M.1  2.44 -1.49       M.1
M.2 -1.23  0.59       M.2
M.3 -0.09 -0.09       M.3
M.4  0.46  1.49       M.4
M.5 -0.19 -0.02       M.5
M.6 -0.28 -1.21       M.6</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Figura con vectores de variables morfométricas</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sitios</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> coord.sit,<span class="fu">aes</span>(LD1,LD2,<span class="at">label=</span><span class="fu">row.names</span>(coord.sit)),</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size=</span><span class="dv">4</span>)<span class="sc">+</span>   <span class="co"># Muestra el cuadro de la figura</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> coord.sit,<span class="fu">aes</span>(LD1,LD2,<span class="at">colour=</span>grp),<span class="at">size=</span><span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variables morfométricas  </span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> coord.var,<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> LD1<span class="sc">*</span><span class="dv">2</span>, <span class="at">yend =</span> LD2<span class="sc">*</span><span class="dv">2</span>), </span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">angle=</span><span class="fl">22.5</span>,<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.25</span>,<span class="st">"cm"</span>),</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"closed"</span>),<span class="at">linetype=</span><span class="dv">1</span>, <span class="at">size=</span><span class="fl">0.6</span>,<span class="at">colour =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> coord.var,<span class="fu">aes</span>(LD1<span class="sc">*</span><span class="dv">2</span>,LD2<span class="sc">*</span><span class="dv">2</span>,<span class="at">label=</span>variables),<span class="at">colour =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Grupos (Especies de peces)</span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mark_ellipse</span>(<span class="at">data=</span>coord.sit,<span class="fu">aes</span>(<span class="at">x=</span>LD1,<span class="at">y=</span>LD2,<span class="at">fill=</span>grp),<span class="at">alpha=</span><span class="fl">0.30</span>) <span class="sc">+</span></span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="dv">3</span>,<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="dv">3</span>,<span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="cn">NULL</span>,<span class="at">color=</span><span class="st">"black"</span>),</span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="cn">NULL</span>))<span class="sc">+</span></span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid=</span><span class="fu">element_blank</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller7-10.cla---permanovas.peces_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="taller-8.2-análisis-discriminante-canónico---dca" class="level2">
<h2 class="anchored" data-anchor-id="taller-8.2-análisis-discriminante-canónico---dca">Taller 8.2 ANÁLISIS DISCRIMINANTE CANÓNICO - DCA</h2>
<p>El siguiente análisis permite visualizar la influencia de cada variable morfométrica en la separación de los grupos de especies y selecciona a las variables que presentan más influencia en la discriminación de los peces.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(peces)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(peces)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "...1"    "Especie" "Grupo"   "M.1"     "M.2"     "M.3"     "M.4"    
 [8] "M.5"     "M.6"     "M.7"     "M.8"     "M.9"     "M.10"    "M.11"   
[15] "M.12"    "M.13"    "M.14"    "M.15"    "M.16"    "M.17"    "M.18"   
[22] "M.19"    "M.20"    "M.21"    "M.22"    "M.23"    "M.24"    "M.25"   
[29] "M.26"    "M.27"    "M.28"    "M.29"   </code></pre>
</div>
</div>
<section id="figura-del-dca" class="level4">
<h4 class="anchored" data-anchor-id="figura-del-dca">Figura del DCA</h4>
<p>Lo primero que se realiza es el modelo lineal <code>mod</code> indicando las variables y los grupos a discriminar.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo Lineal multivariado con las variables morfom?tricas de peces</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">cbind</span>(M<span class="fl">.1</span>,M<span class="fl">.2</span>,M<span class="fl">.3</span>,M<span class="fl">.4</span>,M<span class="fl">.5</span>,M<span class="fl">.6</span>,M<span class="fl">.7</span>,M<span class="fl">.13</span>,M<span class="fl">.15</span>,M<span class="fl">.18</span>) <span class="sc">~</span> Especie,peces)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen del modelo multivariado</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mod)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Posteriormente realiza el discriminante canónico <code>can</code> que permite realizar la discriminación de los grupos en los ejes canónicos.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Análisis discriminante canónico - ADC</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>can <span class="ot">&lt;-</span> <span class="fu">candisc</span>(mod, <span class="at">term=</span><span class="st">"Especie"</span>,<span class="at">data=</span>peces,<span class="at">ndim=</span><span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>A continuación se presenta la <a href="#fig-fig14" class="quarto-xref">Figura&nbsp;14</a> que define a la discriminación de las especies con un solo eje canónico el cual explica el 81.8% de la variación de los datos. La orientación de los vectores (variables morfométricas), en relación a las cajas, indica su importancia para discriminar a cada especie o grupo en comparación.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(can,<span class="at">titles.1d =</span> <span class="fu">c</span>(<span class="st">"Puntuación canónica"</span>, <span class="st">"Estructura"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig14" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig14-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Taller7-10.cla---permanovas.peces_files/figure-html/fig-fig14-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig14-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;14: Mapa de calor que relaciona a las variables morfométricas y a las especies de peces.
</figcaption>
</figure>
</div>
</div>
</div>
<p>En el siguiente enlace se puede obtener un caso aplicado con este tipo de análisis multivariados: <a href="https://www.redalyc.org/articulo.oa?id=180343692007">Aguirre et al.&nbsp;(2015)</a>. Ver la figura 2 del manuscrito en mención.</p>
<hr>
</section>
</section>
<section id="taller-9.-análisis-de-varianza-multivariado---manovas" class="level2">
<h2 class="anchored" data-anchor-id="taller-9.-análisis-de-varianza-multivariado---manovas">Taller 9. ANÁLISIS DE VARIANZA MULTIVARIADO - MANOVAS</h2>
<section id="paso-1.-pruebas-de-supuestos-1" class="level4">
<h4 class="anchored" data-anchor-id="paso-1.-pruebas-de-supuestos-1">Paso 1. Pruebas de supuestos</h4>
<p>Para que el análisis de varianza multivariado - manova sea considerado como un modelo lineal, debe cumplir con los supuestos de normalidad multivariada, de homogeneidad de covarianzas y de independencia. Para el caso del presente ejercicio, los dos primeros supuestos no alcanzan a cumplirse con los diagnosticos utilizados (valor p &lt; 0.05), motivo por el cual, el <code>manova</code> de este ejercicio será tomado como una técnica de exploración multivariada para evaluar las diferencias en las 5 especies, basado en las 10 variables morfomètricas seleccionadas.En el siguiente ejercicio se realizarán análisis de varianza no paramétricos <code>pemanovas</code>, que permiten probar hipótesis sin el cumplimiento de ls dos primeros supuestos, por lo cual serán los diseños multivariados más apropiados para esta base de datos.</p>
<section id="supuesto-de-normalidad-1" class="level5">
<h5 class="anchored" data-anchor-id="supuesto-de-normalidad-1">1.1 Supuesto de normalidad</h5>
<p>El supuesto de normalidad multivariada será evaluado con el paquete <code>mvnormtest</code>, el cual utiliza el estadìstico de <code>Shapiro Wilks Multivariado</code>. Para ello se realizarà esta prueba en cada uno de los grupos o especies en comparación. <strong>NOTA</strong>: Este supuesto también será evaluado con los <code>residuales del manova</code>, posterior a su ejecución.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnóstico de normalidad por cada tipo de Especie</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvnormtest)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Los siguientes generan los dataframes de cada especie con las 10 variables seleccionadas, convirtiendola ademàs en formato matricial.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataframe por cada especie</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="co"># datos de P. chola.</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>P.chola   <span class="ot">&lt;-</span> peces <span class="sc">%&gt;%</span> </span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Especie <span class="sc">==</span> <span class="st">"P. chola"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,<span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span>              <span class="fu">as.matrix</span>()</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="co"># datos de P. conchonious.</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>P.concho  <span class="ot">&lt;-</span> peces <span class="sc">%&gt;%</span> </span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Especie <span class="sc">==</span> <span class="st">"P. conchonious"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,<span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span>              <span class="fu">as.matrix</span>() </span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="co"># datos de P. sophore.</span></span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>P.sophore <span class="ot">&lt;-</span> peces <span class="sc">%&gt;%</span> </span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Especie <span class="sc">==</span> <span class="st">"P. sophore"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,<span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span>              <span class="fu">as.matrix</span>()     </span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a><span class="co"># datos de P. ticto.</span></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>P.ticto   <span class="ot">&lt;-</span> peces <span class="sc">%&gt;%</span> </span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Especie <span class="sc">==</span> <span class="st">"P. ticto"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,<span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span>              <span class="fu">as.matrix</span>()       </span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a><span class="co"># datos de P. ticto.</span></span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>S.sarana  <span class="ot">&lt;-</span> peces <span class="sc">%&gt;%</span> </span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Especie <span class="sc">==</span> <span class="st">"S. sarana"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,<span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span>              <span class="fu">as.matrix</span>()  </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Vale la pena resaltar que los datos de las especies P. chola y P. sophore, son singulares, por lo cual no puede calcularse su supuesto de normalidad multivariada. Con el objeto de continuar en el ejercicio, las matrices que representan a las especies en menciòn, seràn desactivadas con <code>#</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prueba de normalidad para cada especie</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvnormtest)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="co"># norm1 &lt;- mshapiro.test(t(P.chola))   # Matriz singular</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>norm2   <span class="ot">&lt;-</span> <span class="fu">mshapiro.test</span>(<span class="fu">t</span>(P.concho))</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="co"># norm3 &lt;- mshapiro.test(t(P.sophore)) # Matriz singular</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>norm4   <span class="ot">&lt;-</span> <span class="fu">mshapiro.test</span>(<span class="fu">t</span>(P.ticto))</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>norm5   <span class="ot">&lt;-</span> <span class="fu">mshapiro.test</span>(<span class="fu">t</span>(S.sarana))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>A continuación se resume el resultado de los tres diagnósticos de normalidad multivariada realizados. Vale la pena mencionar que ninguna especie cumple con dicho supuesto estadóstico (valores p &lt; 0.05), aunque existe la posibilidad de probar con alguna transformación.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen de el diagnóstico de normalidad</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">normalidad =</span> <span class="fu">data.frame</span>(<span class="at">Norm.P.concho =</span> norm2<span class="sc">$</span>p.value,</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Norm.ticto    =</span> norm4<span class="sc">$</span>p.value,</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Norm.sarana   =</span> norm5<span class="sc">$</span>p.value))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Norm.P.concho   Norm.ticto  Norm.sarana
1   0.001050723 2.629679e-08 5.169222e-07</code></pre>
</div>
</div>
</section>
<section id="supuesto-de-homogeneidad-de-covarianzas-1" class="level5">
<h5 class="anchored" data-anchor-id="supuesto-de-homogeneidad-de-covarianzas-1">1.2 Supuesto de homogeneidad de covarianzas</h5>
<p>La prueba de homogeneidad de covarianza o <strong>esfericidad</strong>, corresponde al segundo supuesto del análisis discriminante lineal, se utilizará la función <code>betadisper</code>, la cual es complementada por dos análisis de varianza, los cuales definirán si el supuesto logra ser cumplido.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pruebas de Homogeneidad de covarianzas paquete "vegan"</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>peces.d <span class="ot">&lt;-</span> <span class="fu">dist</span>(peces[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">20</span>)])                <span class="co"># Matriz de distancias</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>peces.homoge <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(peces.d, peces<span class="sc">$</span>Especie)      <span class="co"># Permutest</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Con la siguiente <code>anova</code> se obtiene un valor p de 0.016*, lo cual indica que no se cumple el supuesto de homogeneidad de covarianzas (valor p &lt; 0.05).</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Prueba con anova permutacional</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(peces.homoge)  </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Distances
          Df   Sum Sq   Mean Sq F value Pr(&gt;F)
Groups     4 0.005359 0.0013399  0.9084 0.4644
Residuals 65 0.095878 0.0014750               </code></pre>
</div>
</div>
<p>Con el <code>permutest</code> se obtiene un valor p de 0.015*, lo cual indica que tampoco se cumple el supuesto de homogeneidad de covarianzas (valor p &lt; 0.05).</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Prueba permutacional</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(peces.homoge)   <span class="co"># Se cumple el supuesto de homogeneidad </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 999

Response: Distances
          Df   Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
Groups     4 0.005359 0.0013399 0.9084    999  0.465
Residuals 65 0.095878 0.0014750                     </code></pre>
</div>
</div>
</section>
</section>
<section id="paso-2.-análisis-de-varinaza-multivariado---manova" class="level4">
<h4 class="anchored" data-anchor-id="paso-2.-análisis-de-varinaza-multivariado---manova">Paso 2. Análisis de Varinaza Multivariado - MANOVA</h4>
<p>El manova, por ser un modelo lineal especial, requiere que se indiquen las variables continuas (variables Xi) y la variable cualitativa o categórica (variable Yi), que para este caso es la Especie.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manova (variables efecto: 10 morfológicas y la respuesta: Especie)</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(peces)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>peces.manova<span class="ot">&lt;-</span><span class="fu">manova</span>(<span class="fu">cbind</span>(M<span class="fl">.1</span>,M<span class="fl">.2</span>,M<span class="fl">.3</span>,M<span class="fl">.4</span>,M<span class="fl">.5</span>,M<span class="fl">.6</span>,M<span class="fl">.7</span>,M<span class="fl">.13</span>,M<span class="fl">.15</span>,M<span class="fl">.18</span>)<span class="sc">~</span>Especie)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>A continuación se presentará la tabla del manova para las tres primeras variables morfométricas. Para visualizar todos los resultados de este insumo, es necesario colocar solo: <code>summary.aov(peces.manova)</code>. Para este caso se observa que todas las variables efecto o morfológicas, tienen un efecto muy significativo (valor p &lt;&lt;0.01) en la diferenciaciación de los 5 grupos o especies de peces.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># respuesta de la variable M.1</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(peces.manova)<span class="sc">$</span><span class="st">" Response M.1"</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df   Sum Sq  Mean Sq F value    Pr(&gt;F)    
Especie      4 0.221052 0.055263  127.36 &lt; 2.2e-16 ***
Residuals   65 0.028205 0.000434                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># respuesta de la variable M.2</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(peces.manova)<span class="sc">$</span><span class="st">" Response M.2"</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df  Sum Sq  Mean Sq F value    Pr(&gt;F)    
Especie      4 0.28343 0.070857   34.76 1.654e-15 ***
Residuals   65 0.13250 0.002038                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># respuesta de la variable M.3</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(peces.manova)<span class="sc">$</span><span class="st">" Response M.3"</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df   Sum Sq    Mean Sq F value   Pr(&gt;F)    
Especie      4 0.010738 0.00268443  10.486 1.29e-06 ***
Residuals   65 0.016641 0.00025601                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>A continuación se presentan los cuatro tipos de MANOVAS, con la diferencia de que Hotelling puede utilizarse sin el cumplimiento del supuesto de normalidad multivariada (pero deben cumplirse los otros supuestos como el de la homogeneidad y el de la independencia). Para este caso los 4 estadísticos muestran altas diferencias entre algunos de los grupos representados por las cinco especies, posiblemente por el efecto de P. sarana, que al ser de un género diferente, presenta marcadas diferencias morfológicas (ver <a href="#fig-fig15" class="quarto-xref">Figura&nbsp;15</a>).</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tipos de MANOVA para evaluar si hay diferencias en los promedios de cada Especie </span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(peces.manova,<span class="at">test=</span><span class="st">"Pillai"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          Df Pillai approx F num Df den Df    Pr(&gt;F)    
Especie    4  2.513   9.9711     40    236 &lt; 2.2e-16 ***
Residuals 65                                            
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(peces.manova,<span class="at">test=</span><span class="st">"Wilks"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          Df     Wilks approx F num Df den Df    Pr(&gt;F)    
Especie    4 0.0028912   19.667     40  214.2 &lt; 2.2e-16 ***
Residuals 65                                               
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(peces.manova,<span class="at">test=</span><span class="st">"Hotelling"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          Df Hotelling-Lawley approx F num Df den Df    Pr(&gt;F)    
Especie    4           29.052   39.584     40    218 &lt; 2.2e-16 ***
Residuals 65                                                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(peces.manova,<span class="at">test=</span><span class="st">"Roy"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          Df    Roy approx F num Df den Df    Pr(&gt;F)    
Especie    4 23.757   140.17     10     59 &lt; 2.2e-16 ***
Residuals 65                                            
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="paso-3.-supuestos-del-manova" class="level4">
<h4 class="anchored" data-anchor-id="paso-3.-supuestos-del-manova">Paso 3. Supuestos del MANOVA</h4>
<p>SOn tres los supuestos que a continuación se probarán: (1) Normalidad en los residuales, (2) homogeneidad de las covarianzas y (3) Independiencia en los datos. Vale la pena resaltar la importancia del cumplimiento de la independiencia, debido a que presenta un efecto sobre diseños que requieran ser aleatorios. La homogeneidad fue diagnosticada al inicio de este ejercicio no se cumple.</p>
<section id="supuesto-de-normalidad-de-los-residuales-del-manova" class="level5">
<h5 class="anchored" data-anchor-id="supuesto-de-normalidad-de-los-residuales-del-manova">3.1. Supuesto de normalidad de los residuales del MANOVA</h5>
<p>A continuación se probará el supuesto de (1) normalidad en los residuales del manova, de forma numérica y gráfica. El estadístico de Shapiro Wilks Multivariado es el que se utiliza, demostrando que los residuales están muy alejados del patrón normal (valor p &lt;&lt; 0.01 o p = 3.043e-07).</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Prueba de multinormalidad de los residuales del manova (mshapiro.test)</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvnormtest)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">t</span>(<span class="fu">residuals</span>(peces.manova)))</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mshapiro.test</span>(x)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  Z
W = 0.83893, p-value = 3.043e-07</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No se cumple este supuesto</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>A continuación se hará uso del código fuente “<code>funciones.r</code>” el cual presenta los comandos requeridos para la figura que diagnostica la normalidad multivariada (<a href="#fig-fig15" class="quarto-xref">Figura&nbsp;15</a> qqplot).</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura de multinormalidad</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Funciones para la figura</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"funciones.r"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>En la <a href="#fig-fig15" class="quarto-xref">Figura&nbsp;15</a> se observa que algunos residuales (puntos circulares) se alejan considerablemente del patrón de normalidad, definido por la recta roja.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafica QQ-PLot para visualizar la normalidad</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">residuals</span>(peces.manova)) </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="co"># centroide</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>center <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(x) </span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x); p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(x); cov <span class="ot">&lt;-</span> <span class="fu">cov</span>(x); </span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">mahalanobis</span>(x,center,cov) </span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(<span class="fu">qchisq</span>(<span class="fu">ppoints</span>(n),<span class="at">df=</span>p),d,</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span><span class="st">"Normalidad multivariada"</span>,</span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab=</span><span class="st">"Cuantil Chi-Cuadrado"</span>, <span class="at">xlab=</span> <span class="st">"Distancia Mahalanobish"</span>)</span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>,<span class="at">col=</span><span class="dv">2</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig15" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig15-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Taller7-10.cla---permanovas.peces_files/figure-html/fig-fig15-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig15-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;15: Figura qqplot entre los residuales observados (Distancia Mahalanobish) y los cuantiles chi cuadrado (estimados).
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="supuesto-de-independencia" class="level5">
<h5 class="anchored" data-anchor-id="supuesto-de-independencia">3.2. Supuesto de independencia</h5>
<p>Se utilizará el estadístico Durbin Watson (DW) el cual demuestra que se cumple la independencia (valor p &gt; 0.05).</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prueba de Independencia - Estadistico Durbin Watson</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(peces)</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>modelo<span class="ot">&lt;-</span><span class="fu">lm</span>(M<span class="fl">.1</span><span class="sc">+</span>M<span class="fl">.2</span><span class="sc">+</span>M<span class="fl">.3</span><span class="sc">+</span>M<span class="fl">.4</span><span class="sc">+</span>M<span class="fl">.5</span><span class="sc">+</span>M<span class="fl">.6</span><span class="sc">+</span>M<span class="fl">.7</span><span class="sc">+</span>M<span class="fl">.13</span><span class="sc">+</span>M<span class="fl">.15</span><span class="sc">+</span>M<span class="fl">.18</span><span class="sc">~</span>Especie)</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="fu">durbinWatsonTest</span>(modelo)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> lag Autocorrelation D-W Statistic p-value
   1      0.08444408       1.80425   0.214
 Alternative hypothesis: rho != 0</code></pre>
</div>
</div>
</section>
</section>
<section id="paso-4.-prueba-a-postriori-del-manova" class="level4">
<h4 class="anchored" data-anchor-id="paso-4.-prueba-a-postriori-del-manova">Paso 4. Prueba a postriori del MANOVA</h4>
<p>A continuación, se realizará una figura del análisis discriminante - <em>lda</em>, que permitirá generar definir al nivel de discriminación de cada grupo o especie de pez. Se presentan algunas opciones gráficas con el procedimiento general y con el análisis discriminate canónico (dca)</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo del LDA</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(peces)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "...1"    "Especie" "Grupo"   "M.1"     "M.2"     "M.3"     "M.4"    
 [8] "M.5"     "M.6"     "M.7"     "M.8"     "M.9"     "M.10"    "M.11"   
[15] "M.12"    "M.13"    "M.14"    "M.15"    "M.16"    "M.17"    "M.18"   
[22] "M.19"    "M.20"    "M.21"    "M.22"    "M.23"    "M.24"    "M.25"   
[29] "M.26"    "M.27"    "M.28"    "M.29"   </code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>dis<span class="ot">&lt;-</span><span class="fu">lda</span> (Especie <span class="sc">~</span> M<span class="fl">.1</span><span class="sc">+</span>M<span class="fl">.2</span><span class="sc">+</span>M<span class="fl">.3</span><span class="sc">+</span>M<span class="fl">.4</span><span class="sc">+</span>M<span class="fl">.5</span><span class="sc">+</span>M<span class="fl">.6</span><span class="sc">+</span>M<span class="fl">.7</span><span class="sc">+</span>M<span class="fl">.13</span><span class="sc">+</span>M<span class="fl">.15</span><span class="sc">+</span>M<span class="fl">.18</span>,</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> peces)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>A continuación se realizará el componente grafico del lda, el cual inicia con una figura que definirá unas elipses, las cuales relacionan a los individuos de cada especie y cuyo solapamiento definirá el nivel de relación entre estas.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Escores o coordenadas de las observaciones en cada eje can?nico</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>Fp <span class="ot">&lt;-</span> <span class="fu">predict</span>(dis)<span class="sc">$</span>x</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grupos asignados por el AD</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>group<span class="ot">&lt;-</span><span class="fu">predict</span>(dis,<span class="at">method=</span><span class="st">"plug-in"</span>)<span class="sc">$</span>class</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coordenadas y grupos asignados</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>peces.coord<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">Especie=</span>group,Fp)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>La <a href="#fig-fig16" class="quarto-xref">Figura&nbsp;16</a> demuestra que si bien de presenta una buena discriminación de las especies de peces, 4 de las 5 evaluadas presentan cierta relación, definida por el solapamiento de sus elipses.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura del LDA</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(peces)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplot</span>(LD2<span class="sc">~</span>LD1 <span class="sc">|</span> Especie, <span class="at">data=</span>peces.coord,<span class="at">reg.line=</span><span class="cn">FALSE</span>, </span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">smooth=</span>F, <span class="at">spread=</span>F,<span class="at">span=</span> <span class="dv">1</span>,<span class="at">grid=</span>F,</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend=</span><span class="fu">list</span>(<span class="at">coords=</span><span class="st">"bottom"</span>), </span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">ellipse=</span>T,<span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">19</span>),</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">col=</span><span class="fu">c</span>(<span class="st">'#fc8d59'</span>,<span class="st">'#e41a1c'</span>,<span class="st">'#984ea3'</span>,<span class="st">'#377eb8'</span>,<span class="st">'#33a02c'</span>),</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">main=</span><span class="st">"Análisis discriminante"</span>,</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">font.main=</span><span class="dv">2</span>,<span class="at">cex.main=</span><span class="dv">2</span>,<span class="at">cex.lab=</span><span class="fl">1.5</span>,</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab=</span><span class="st">"Eje1"</span>, <span class="at">ylab=</span><span class="st">"Eje2"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig16" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Taller7-10.cla---permanovas.peces_files/figure-html/fig-fig16-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;16: Mapa de calor que relaciona a las variables morfométricas y a las especies de peces.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="taller-10.-manovas-permutacionales---permanovas" class="level2">
<h2 class="anchored" data-anchor-id="taller-10.-manovas-permutacionales---permanovas">Taller 10. MANOVAS PERMUTACIONALES - PERMANOVAS</h2>
<section id="objetivo-de-la-actividad-1" class="level4">
<h4 class="anchored" data-anchor-id="objetivo-de-la-actividad-1">Objetivo de la actividad:</h4>
<p>La base de datos que se utilizará es la de medidas morfométricas de peces de un estudio realizado con peces de la india por <strong>Gupta et al.&nbsp;(2018)</strong> <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6203374/">Articulo fuente</a> en los que se validó la taxonomía de peces de la subfamilia Barbinae, utilizando 19 variables morfométricas y 19 variables meristicas, correspondientes a 5 Especie de la familia en mención.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><embed src="https://www.ncbi.nlm.nih.gov/core/lw/2.0/html/tileshop_pmc/tileshop_pmc_inline.html?title=Click%20on%20image%20to%20zoom&amp;p=PMC3&amp;id=6203374_pone.0206031.g002.jpg" class="img-fluid" style="width:80.0%"></p>
<figcaption><n style="color:#1f78b4;"> Imágen tomada de <em>Gupta et al.&nbsp;(2018)</em> (a) <em>S . Sarana</em> (b) <em>P . ticto</em> (c) <em>P . sóforo</em> , (d) <em>P . conconio</em> y (e) <em>P . chola</em> </n></figcaption>
</figure>
</div>
<p>El <strong>objetivo</strong> de este ejercicio consiste evaluar la variación morfométrica que se presenta en los peces de cada especie (grupos en comparación), para conocer si los atributos morfométricos generan diferencias en cada grupo evaluado, basado en pruebas de varianza no paramétricos. La base de datos que se utilizará es <strong>datos.xlsx</strong>.</p>
</section>
<section id="cargar-o-importar-la-base-de-datos-2" class="level4">
<h4 class="anchored" data-anchor-id="cargar-o-importar-la-base-de-datos-2">Cargar o importar la base de datos</h4>
<p>La presente base de datos se encuentra en formato plano de <code>csv</code>, presenta una columna <code>Especie</code> que agrupa a las 5 Especie de peces, otra columna <code>Grupo</code>, que asigna un número a cada especie y posteriormente a las 19 variables morfométricas y 10 variables meristicas, de las cuales se selecionarán las 10 morfométricas para este ejercicio <code>M.1 a M.7, M.13 a M.15 y M.18</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base de datos</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>peces<span class="ot">&lt;-</span><span class="fu">read_xlsx</span>(<span class="st">"datos.xlsx"</span>)</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="co"># names(peces)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exploración-de-los-datos-2" class="level4">
<h4 class="anchored" data-anchor-id="exploración-de-los-datos-2">Exploración de los datos</h4>
<section id="figura-de-cajas-por-cada-variable-morfométrica" class="level5">
<h5 class="anchored" data-anchor-id="figura-de-cajas-por-cada-variable-morfométrica">Figura de <em>cajas</em> por cada variable morfométrica</h5>
<p>La <a href="#fig-fig17" class="quarto-xref">Figura&nbsp;17</a> permite visualizar la resolución de cada variable para diferenciar o discriminar a las diferentes especies de peces. Esta figura sirve de insumo para descartar aquellas variables con poco potencial de discriminación de las especies.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figuras multivariadas de Cajas y bigotes</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape)</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">melt</span>(peces[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">16</span>,<span class="dv">18</span>,<span class="dv">21</span>)]), <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill=</span>Especie)) <span class="sc">+</span> </span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'#fc8d59'</span>,<span class="st">'#ffffbf'</span>,<span class="st">'#99d594'</span>,<span class="st">'#377eb8'</span>,<span class="st">'#33a02c'</span>)) <span class="sc">+</span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,<span class="at">y=</span><span class="st">"Morfometría"</span>) <span class="sc">+</span> </span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable,<span class="at">scales=</span><span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig17" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig17-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Taller7-10.cla---permanovas.peces_files/figure-html/fig-fig17-1.svg" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig17-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;17: Variación en la morfometría de los peces, de acuerdo a cada una de las variables seleccionadas.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="figura-del-lda-para-comparar-a-las-especies-de-peces" class="level4">
<h4 class="anchored" data-anchor-id="figura-del-lda-para-comparar-a-las-especies-de-peces">Figura del <em>lda</em> para comparar a las especies de peces</h4>
<p>A continuación, se realizará una figura del análisis discriminante - <em>lda</em>, que permitirá generar definir al nivel de discriminación de cada grupo o especie de pez. Se presentan algunas opciones gráficas con el procedimiento general y con el análisis discriminate canónico (dca)</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo del LDA</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(peces)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "...1"    "Especie" "Grupo"   "M.1"     "M.2"     "M.3"     "M.4"    
 [8] "M.5"     "M.6"     "M.7"     "M.8"     "M.9"     "M.10"    "M.11"   
[15] "M.12"    "M.13"    "M.14"    "M.15"    "M.16"    "M.17"    "M.18"   
[22] "M.19"    "M.20"    "M.21"    "M.22"    "M.23"    "M.24"    "M.25"   
[29] "M.26"    "M.27"    "M.28"    "M.29"   </code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>dis<span class="ot">&lt;-</span><span class="fu">lda</span> (Especie <span class="sc">~</span> M<span class="fl">.1</span><span class="sc">+</span>M<span class="fl">.2</span><span class="sc">+</span>M<span class="fl">.3</span><span class="sc">+</span>M<span class="fl">.4</span><span class="sc">+</span>M<span class="fl">.5</span><span class="sc">+</span>M<span class="fl">.6</span><span class="sc">+</span>M<span class="fl">.7</span><span class="sc">+</span>M<span class="fl">.13</span><span class="sc">+</span>M<span class="fl">.15</span><span class="sc">+</span>M<span class="fl">.18</span>,</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> peces)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>A continuación se realizará el componente grafico del lda, el cual inicia con una figura que definirá unas elipses, las cuales relacionan a los individuos de cada especie y cuyo solapamiento definirá el nivel de relación entre estas.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Escores o coordenadas de las observaciones en cada eje can?nico</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>Fp <span class="ot">&lt;-</span> <span class="fu">predict</span>(dis)<span class="sc">$</span>x</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grupos asignados por el AD</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>group<span class="ot">&lt;-</span><span class="fu">predict</span>(dis,<span class="at">method=</span><span class="st">"plug-in"</span>)<span class="sc">$</span>class</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coordenadas y grupos asignados</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>peces.coord<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">Especie=</span>group,Fp)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>La <a href="#fig-fig18" class="quarto-xref">Figura&nbsp;18</a> demuestra que si bien de presenta una buena discriminación de las especies de peces, 4 de las 5 evaluadas presentan cierta relación, definida por el solapamiento de sus elipses.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura del LDA</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(peces)</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplot</span>(LD2<span class="sc">~</span>LD1 <span class="sc">|</span> Especie, <span class="at">data=</span>peces.coord,<span class="at">reg.line=</span><span class="cn">FALSE</span>, </span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">smooth=</span>F, <span class="at">spread=</span>F,<span class="at">span=</span> <span class="dv">1</span>,<span class="at">grid=</span>F,</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend=</span><span class="fu">list</span>(<span class="at">coords=</span><span class="st">"bottom"</span>), </span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">ellipse=</span>T,<span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">19</span>),</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">col=</span><span class="fu">c</span>(<span class="st">'#fc8d59'</span>,<span class="st">'#e41a1c'</span>,<span class="st">'#984ea3'</span>,<span class="st">'#377eb8'</span>,<span class="st">'#33a02c'</span>),</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">main=</span><span class="st">"Análisis discriminante"</span>,</span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">font.main=</span><span class="dv">2</span>,<span class="at">cex.main=</span><span class="dv">2</span>,<span class="at">cex.lab=</span><span class="fl">1.5</span>,</span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab=</span><span class="st">"Eje1"</span>, <span class="at">ylab=</span><span class="st">"Eje2"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig18" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig18-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Taller7-10.cla---permanovas.peces_files/figure-html/fig-fig18-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig18-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;18: Mapa de calor que relaciona a las variables morfométricas y a las especies de peces.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="permanova-1.-análisis-de-similitudes-multivariadas---anosim" class="level3">
<h3 class="anchored" data-anchor-id="permanova-1.-análisis-de-similitudes-multivariadas---anosim">Permanova 1. Análisis de similitudes multivariadas - ANOSIM</h3>
<section id="paso-1.-distancia-entre-las-observaciones" class="level5">
<h5 class="anchored" data-anchor-id="paso-1.-distancia-entre-las-observaciones">Paso 1. Distancia entre las observaciones</h5>
<p>Se utilizará la distancia euclídea, debido a las relaciones lineales que existen entre las variables morfométricas.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distancia Euclídea con las 10 variables seleccionadas</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>peces.dist<span class="ot">&lt;-</span><span class="fu">dist</span>(peces[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">20</span>)],<span class="st">"euclid"</span>)</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="co"># round(peces.dist, 2)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="paso-2.-prueba-de-hipótesis-multivariada-con-el-anosim" class="level5">
<h5 class="anchored" data-anchor-id="paso-2.-prueba-de-hipótesis-multivariada-con-el-anosim">Paso 2. Prueba de hipótesis multivariada con el ANOSIM</h5>
<ul>
<li><p><strong>ANOSIM statistic</strong> = representa al estadístico de Clarc (R). Como R &gt; 0 (= 0.82) indica que hay fuertes diferencias entre las especies de peces, basado en su morfometría.</p></li>
<li><p><strong>Significance</strong>: 0.0009, indica que las diferencias entre los grupos son altamente significativas (significancia de la permutación).</p></li>
<li><p><strong>Disimilarity ranks</strong>: Rangos de similitud entre y dentro de los grupos de Especies a diferentes percentiles (ver la siguiente figura que se muestra a continuación). De esta manera se reportan los resultados del estadístico MRPP: (R= 0.83, n= 70, p = 0.00099).</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOSIM</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>peces.anosim <span class="ot">&lt;-</span> <span class="fu">anosim</span>(peces.dist, peces<span class="sc">$</span>Especie, <span class="at">permutations=</span><span class="dv">1000</span>)</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(peces.anosim)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
anosim(x = peces.dist, grouping = peces$Especie, permutations = 1000) 
Dissimilarity: euclidean 

ANOSIM statistic R:     1 
      Significance: 0.000999 

Permutation: free
Number of permutations: 1000

Upper quantiles of permutations (null model):
   90%    95%  97.5%    99% 
0.0454 0.0579 0.0705 0.0834 

Dissimilarity ranks between and within classes:
                0%      25%     50%      75%   100%    N
Between        576 1035.750 1496.25 1955.375 2414.5 1840
P. chola         5   73.125  256.75  427.500  538.5   66
P. conchonious  18  257.500  363.50  442.125  545.0   28
P. sophore      35  260.000  468.00  542.000  575.0   15
P. ticto         5  141.000  305.00  463.500  571.0  190
S. sarana       11  145.250  269.50  406.250  573.0  276</code></pre>
</div>
</div>
<p>La figura es una gráfica de cajas y bigotes con muescas que visualiza la comparación de medianas generadas por las 1000 permutaciones, para comparar a las cinco especies de peces, entre y dentro de los grupos formados priori. De acuerdo con esta figura, todos los grupos son diferentes entre sí (sus cinturas o muescas no se solapan horizontalmente con la de la primera caja).</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura del Anosim</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(peces.anosim,<span class="at">las=</span><span class="dv">1</span>, <span class="at">col=</span> <span class="st">"#fc8d59"</span>, <span class="at">ylab=</span> <span class="st">"Rangos de distancia"</span>,</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Especies"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller7-10.cla---permanovas.peces_files/figure-html/unnamed-chunk-105-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="permanova-2.-permutación-multirespuesta---mrpp" class="level3">
<h3 class="anchored" data-anchor-id="permanova-2.-permutación-multirespuesta---mrpp">Permanova 2. Permutación multirespuesta - MRPP</h3>
<section id="paso-1.-distancia-entre-las-observaciones-1" class="level5">
<h5 class="anchored" data-anchor-id="paso-1.-distancia-entre-las-observaciones-1">Paso 1. Distancia entre las observaciones</h5>
<p>Se utilizará la distancia euclídea calculada para el anterior ANOSIM.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distancia Euclídea con las 10 variables seleccionadas</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>peces.dist<span class="ot">&lt;-</span><span class="fu">dist</span>(peces[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">20</span>)],<span class="st">"euclid"</span>)</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="co"># round(peces.dist, 2)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="paso-2.-prueba-de-hipótesis-multivariada-con-el-mrpp" class="level5">
<h5 class="anchored" data-anchor-id="paso-2.-prueba-de-hipótesis-multivariada-con-el-mrpp">Paso 2. Prueba de hipótesis multivariada con el MRPP</h5>
<ul>
<li><p><strong>Class means and counts</strong>: Corresponde al estadístico delta del MRPP (δ), evaluados para cada grupo o especie de pez, que muestra un nivel bajo de correlación intragrupo (Pearson tipo III de 0.16).</p></li>
<li><p><strong>Delta observado</strong> (0.16) &lt; <strong>delta esperado</strong> por permutación (0.28), con lo que la diferenciación entre las cinco especies de peces es altamente significativo (p-valor: 0.0009). En este sentido se determina que las especies son diferentes en su morfología. De esta manera se reportan los resultados del estadístico MRPP: (MRPP= 0.16, n= 70, p = 0.00099).</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prueba de hipótesis de diferencias en los grupos de Especies, mediante el MRPP</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>peces.mrpp <span class="ot">&lt;-</span> <span class="fu">mrpp</span>(peces.dist, peces<span class="sc">$</span>Especie, <span class="at">permutations=</span><span class="dv">1000</span>)</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>peces.mrpp</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
mrpp(dat = peces.dist, grouping = peces$Especie, permutations = 1000) 

Dissimilarity index: euclidean 
Weights for groups:  n 

Class means and counts:

      P. chola P. conchonious P. sophore P. ticto S. sarana
delta 0.1174   0.1445         0.181      0.1343   0.1288   
n     12       8              6          20       24       

Chance corrected within-group agreement A: 0.9177 
Based on observed delta 0.1347 and expected delta 1.636 

Significance of delta: 0.000999 
Permutation: free
Number of permutations: 1000</code></pre>
</div>
</div>
</section>
</section>
<section id="permanova-3.-permanova-de-un-factor-especies-de-peces" class="level3">
<h3 class="anchored" data-anchor-id="permanova-3.-permanova-de-un-factor-especies-de-peces">Permanova 3. PERMANOVA de un factor (Especies de peces)</h3>
<p>Este es el análisis más similar al MANOVA o análisis de varianza multivariado, pero la construcción de la tabla del MANOVA la hace mediante permutaciones, comparando a la matriz de distancias de los datos observados con otra matriz de distancia estimada por permutaciones.</p>
<section id="paso-1.-distancia-entre-las-observaciones-2" class="level5">
<h5 class="anchored" data-anchor-id="paso-1.-distancia-entre-las-observaciones-2">Paso 1. Distancia entre las observaciones</h5>
<p>Se utilizará la distancia euclídea calculada para el anterior ANOSIM y el MRPP, pero transformando las variables con logaritmo base 10, para mejorar su linealización de los datos.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distancia Euclídea con las 10 variables seleccionadas</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>peces.dist1 <span class="ot">&lt;-</span><span class="fu">dist</span> (<span class="fu">log10</span>(peces[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">20</span>)<span class="sc">+</span><span class="dv">1</span>]),<span class="st">"euclid"</span>)</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="co"># round(peces.dist, 2)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="paso-2.-prueba-de-hipótesis-multivariada-con-el-permanova" class="level5">
<h5 class="anchored" data-anchor-id="paso-2.-prueba-de-hipótesis-multivariada-con-el-permanova">Paso 2. Prueba de hipótesis multivariada con el PERMANOVA</h5>
<p>Similar a las pruebas anteriores, este PERMANOVA permite probar que existen diferencias marcadas en la morfometría de los individuos que se agrupan en las cinco especies de peces (valor p &lt; 0.05). De esta manera se reportan los resultados del estadístico MRPP: (Seudo F= 12.5, g.l= 4 y 65, p = 0.00099***).</p>
<p>library(flextable)</p>
<p>library(tidyverse)</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instalar si no la tienes</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("flextable")</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar</span></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a><span class="co"># PERMANOVA</span></span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>peces.dist1 <span class="ot">&lt;-</span><span class="fu">dist</span> (<span class="fu">log10</span>(peces[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">20</span>)<span class="sc">+</span><span class="dv">1</span>]),<span class="st">"euclid"</span>)</span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a>peces.permanova <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(peces.dist1 <span class="sc">~</span> peces<span class="sc">$</span>Especie, <span class="at">perm=</span><span class="dv">1000</span>)</span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a><span class="co">#peces.permanova</span></span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">Fuente=</span><span class="fu">c</span>(<span class="st">"Factor"</span>,<span class="st">"Error"</span>,<span class="st">"Total"</span>),</span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">df=</span>peces.permanova<span class="sc">$</span>Df,</span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">SC=</span>peces.permanova<span class="sc">$</span>SumOfSqs,</span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">R2=</span>peces.permanova<span class="sc">$</span>R2,</span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">Statistic=</span>peces.permanova<span class="sc">$</span>F,</span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">p=</span>peces.permanova<span class="sc">$</span><span class="st">'Pr(&gt;F)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb163-19"><a href="#cb163-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-e8ab70c0{}.cl-e8a2867c{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e8a4f592{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e8a4f59c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e8a50f64{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e8a50f65{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e8a50f6e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e8a50f6f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e8a50f70{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e8a50f71{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-e8ab70c0"><thead><tr style="overflow-wrap:break-word;"><th class="cl-e8a50f64"><p class="cl-e8a4f592"><span class="cl-e8a2867c">Fuente</span></p></th><th class="cl-e8a50f65"><p class="cl-e8a4f59c"><span class="cl-e8a2867c">df</span></p></th><th class="cl-e8a50f65"><p class="cl-e8a4f59c"><span class="cl-e8a2867c">SC</span></p></th><th class="cl-e8a50f65"><p class="cl-e8a4f59c"><span class="cl-e8a2867c">R2</span></p></th><th class="cl-e8a50f65"><p class="cl-e8a4f59c"><span class="cl-e8a2867c">Statistic</span></p></th><th class="cl-e8a50f65"><p class="cl-e8a4f59c"><span class="cl-e8a2867c">p</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-e8a50f6e"><p class="cl-e8a4f592"><span class="cl-e8a2867c">Factor</span></p></td><td class="cl-e8a50f6f"><p class="cl-e8a4f59c"><span class="cl-e8a2867c">4</span></p></td><td class="cl-e8a50f6f"><p class="cl-e8a4f59c"><span class="cl-e8a2867c">3.268732</span></p></td><td class="cl-e8a50f6f"><p class="cl-e8a4f59c"><span class="cl-e8a2867c">0.5207018</span></p></td><td class="cl-e8a50f6f"><p class="cl-e8a4f59c"><span class="cl-e8a2867c">17.65374</span></p></td><td class="cl-e8a50f6f"><p class="cl-e8a4f59c"><span class="cl-e8a2867c">0.000999001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e8a50f6e"><p class="cl-e8a4f592"><span class="cl-e8a2867c">Error</span></p></td><td class="cl-e8a50f6f"><p class="cl-e8a4f59c"><span class="cl-e8a2867c">65</span></p></td><td class="cl-e8a50f6f"><p class="cl-e8a4f59c"><span class="cl-e8a2867c">3.008818</span></p></td><td class="cl-e8a50f6f"><p class="cl-e8a4f59c"><span class="cl-e8a2867c">0.4792982</span></p></td><td class="cl-e8a50f6f"><p class="cl-e8a4f59c"><span class="cl-e8a2867c"></span></p></td><td class="cl-e8a50f6f"><p class="cl-e8a4f59c"><span class="cl-e8a2867c"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e8a50f70"><p class="cl-e8a4f592"><span class="cl-e8a2867c">Total</span></p></td><td class="cl-e8a50f71"><p class="cl-e8a4f59c"><span class="cl-e8a2867c">69</span></p></td><td class="cl-e8a50f71"><p class="cl-e8a4f59c"><span class="cl-e8a2867c">6.277550</span></p></td><td class="cl-e8a50f71"><p class="cl-e8a4f59c"><span class="cl-e8a2867c">1.0000000</span></p></td><td class="cl-e8a50f71"><p class="cl-e8a4f59c"><span class="cl-e8a2867c"></span></p></td><td class="cl-e8a50f71"><p class="cl-e8a4f59c"><span class="cl-e8a2867c"></span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="paso-3.-efecto-de-las-variables-morfométricas-en-la-diferenciación-de-los-grupos" class="level5">
<h5 class="anchored" data-anchor-id="paso-3.-efecto-de-las-variables-morfométricas-en-la-diferenciación-de-los-grupos">Paso 3. Efecto de las variables morfométricas en la diferenciación de los grupos</h5>
<p>Los resultados de este análisis, permiten definir, que con excepción de las variables M.13 y M.18, todas presentan un efecto significativo en la diferenciación de las especies de peces.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(peces)</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>peces.permanova1<span class="ot">&lt;-</span><span class="fu">adonis</span>(peces.dist1 <span class="sc">~</span> M<span class="fl">.1</span><span class="sc">+</span>M<span class="fl">.2</span><span class="sc">+</span>M<span class="fl">.3</span><span class="sc">+</span>M<span class="fl">.4</span><span class="sc">+</span>M<span class="fl">.5</span><span class="sc">+</span>M<span class="fl">.6</span><span class="sc">+</span>M<span class="fl">.7</span><span class="sc">+</span>M<span class="fl">.13</span><span class="sc">+</span>M<span class="fl">.15</span><span class="sc">+</span>M<span class="fl">.18</span>, </span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">perm=</span><span class="dv">1000</span>)</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>peces.permanova1<span class="sc">$</span><span class="st">"aov.tab"</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation: free
Number of permutations: 1000

Terms added sequentially (first to last)

          Df SumsOfSqs MeanSqs F.Model      R2   Pr(&gt;F)    
M.1        1    2.2190 2.21896 135.578 0.35347 0.000999 ***
M.2        1    0.9099 0.90989  55.594 0.14494 0.000999 ***
M.3        1    0.0682 0.06822   4.168 0.01087 0.019980 *  
M.4        1    0.0672 0.06725   4.109 0.01071 0.022977 *  
M.5        1    0.4313 0.43131  26.353 0.06871 0.000999 ***
M.6        1    0.0721 0.07214   4.408 0.01149 0.027972 *  
M.7        1    0.0798 0.07984   4.878 0.01272 0.015984 *  
M.13       1    0.1354 0.13535   8.270 0.02156 0.000999 ***
M.15       1    0.1960 0.19603  11.978 0.03123 0.000999 ***
M.18       1    1.1329 1.13294  69.222 0.18048 0.000999 ***
Residuals 59    0.9656 0.01637         0.15382             
Total     69    6.2775                 1.00000             
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RVAideMemoire)</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.perm.manova</span>(</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>  peces[, <span class="fu">c</span>(<span class="st">"M.1"</span>, <span class="st">"M.2"</span>, <span class="st">"M.3"</span>, <span class="st">"M.4"</span>, <span class="st">"M.5"</span>, <span class="st">"M.6"</span>, <span class="st">"M.7"</span>, </span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">"M.13"</span>, <span class="st">"M.15"</span>, <span class="st">"M.18"</span>)],</span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>  peces<span class="sc">$</span>Especie,</span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.method =</span> <span class="st">"bonf"</span></span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=                                                                     |   1%
  |                                                                            
  |=                                                                     |   2%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |=====                                                                 |   7%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |===============                                                       |  21%
  |                                                                            
  |===============                                                       |  22%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |=================                                                     |  24%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |======================                                                |  32%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |========================                                              |  34%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |==================================                                    |  48%
  |                                                                            
  |==================================                                    |  49%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================                                  |  51%
  |                                                                            
  |====================================                                  |  52%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |============================================                          |  63%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |==============================================                        |  66%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |================================================                      |  68%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |==================================================                    |  72%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |===================================================================== |  98%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================| 100%

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=                                                                     |   1%
  |                                                                            
  |=                                                                     |   2%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |=====                                                                 |   7%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |===============                                                       |  21%
  |                                                                            
  |===============                                                       |  22%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |=================                                                     |  24%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |======================                                                |  32%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |========================                                              |  34%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |==================================                                    |  48%
  |                                                                            
  |==================================                                    |  49%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================                                  |  51%
  |                                                                            
  |====================================                                  |  52%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |============================================                          |  63%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |==============================================                        |  66%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |================================================                      |  68%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |==================================================                    |  72%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |===================================================================== |  98%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================| 100%

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=                                                                     |   1%
  |                                                                            
  |=                                                                     |   2%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |=====                                                                 |   7%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |===============                                                       |  21%
  |                                                                            
  |===============                                                       |  22%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |=================                                                     |  24%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |======================                                                |  32%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |========================                                              |  34%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |==================================                                    |  48%
  |                                                                            
  |==================================                                    |  49%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================                                  |  51%
  |                                                                            
  |====================================                                  |  52%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |============================================                          |  63%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |==============================================                        |  66%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |================================================                      |  68%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |==================================================                    |  72%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |===================================================================== |  98%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================| 100%

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=                                                                     |   1%
  |                                                                            
  |=                                                                     |   2%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |=====                                                                 |   7%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |===============                                                       |  21%
  |                                                                            
  |===============                                                       |  22%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |=================                                                     |  24%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |======================                                                |  32%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |========================                                              |  34%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |==================================                                    |  48%
  |                                                                            
  |==================================                                    |  49%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================                                  |  51%
  |                                                                            
  |====================================                                  |  52%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |============================================                          |  63%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |==============================================                        |  66%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |================================================                      |  68%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |==================================================                    |  72%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |===================================================================== |  98%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================| 100%

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=                                                                     |   1%
  |                                                                            
  |=                                                                     |   2%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |=====                                                                 |   7%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |===============                                                       |  21%
  |                                                                            
  |===============                                                       |  22%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |=================                                                     |  24%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |======================                                                |  32%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |========================                                              |  34%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |==================================                                    |  48%
  |                                                                            
  |==================================                                    |  49%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================                                  |  51%
  |                                                                            
  |====================================                                  |  52%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |============================================                          |  63%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |==============================================                        |  66%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |================================================                      |  68%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |==================================================                    |  72%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |===================================================================== |  98%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================| 100%

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=                                                                     |   1%
  |                                                                            
  |=                                                                     |   2%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |=====                                                                 |   7%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |===============                                                       |  21%
  |                                                                            
  |===============                                                       |  22%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |=================                                                     |  24%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |======================                                                |  32%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |========================                                              |  34%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |==================================                                    |  48%
  |                                                                            
  |==================================                                    |  49%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================                                  |  51%
  |                                                                            
  |====================================                                  |  52%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |============================================                          |  63%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |==============================================                        |  66%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |================================================                      |  68%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |==================================================                    |  72%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |===================================================================== |  98%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================| 100%

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=                                                                     |   1%
  |                                                                            
  |=                                                                     |   2%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |=====                                                                 |   7%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |===============                                                       |  21%
  |                                                                            
  |===============                                                       |  22%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |=================                                                     |  24%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |======================                                                |  32%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |========================                                              |  34%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |==================================                                    |  48%
  |                                                                            
  |==================================                                    |  49%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================                                  |  51%
  |                                                                            
  |====================================                                  |  52%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |============================================                          |  63%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |==============================================                        |  66%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |================================================                      |  68%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |==================================================                    |  72%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |===================================================================== |  98%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================| 100%

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=                                                                     |   1%
  |                                                                            
  |=                                                                     |   2%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |=====                                                                 |   7%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |===============                                                       |  21%
  |                                                                            
  |===============                                                       |  22%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |=================                                                     |  24%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |======================                                                |  32%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |========================                                              |  34%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |==================================                                    |  48%
  |                                                                            
  |==================================                                    |  49%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================                                  |  51%
  |                                                                            
  |====================================                                  |  52%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |============================================                          |  63%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |==============================================                        |  66%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |================================================                      |  68%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |==================================================                    |  72%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |===================================================================== |  98%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================| 100%

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=                                                                     |   1%
  |                                                                            
  |=                                                                     |   2%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |=====                                                                 |   7%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |===============                                                       |  21%
  |                                                                            
  |===============                                                       |  22%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |=================                                                     |  24%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |======================                                                |  32%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |========================                                              |  34%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |==================================                                    |  48%
  |                                                                            
  |==================================                                    |  49%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================                                  |  51%
  |                                                                            
  |====================================                                  |  52%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |============================================                          |  63%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |==============================================                        |  66%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |================================================                      |  68%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |==================================================                    |  72%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |===================================================================== |  98%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================| 100%

  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=                                                                     |   1%
  |                                                                            
  |=                                                                     |   2%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |=====                                                                 |   7%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |===============                                                       |  21%
  |                                                                            
  |===============                                                       |  22%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |=================                                                     |  24%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |======================                                                |  32%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |========================                                              |  34%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |==================================                                    |  48%
  |                                                                            
  |==================================                                    |  49%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================                                  |  51%
  |                                                                            
  |====================================                                  |  52%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |============================================                          |  63%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |==============================================                        |  66%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |================================================                      |  68%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |==================================================                    |  72%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |===================================================================== |  98%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using permutation MANOVAs (test: Pillai) 

data:  peces[, c("M.1", "M.2", "M.3", "M.4", "M.5", "M.6", "M.7", "M.13",  by peces$Especie
999 permutations     "M.15", "M.18")] by peces$Especie
999 permutations 

               P. chola P. conchonious P. sophore P. ticto
P. conchonious 0.02     -              -          -       
P. sophore     1.00     0.04           -          -       
P. ticto       0.01     0.01           0.01       -       
S. sarana      0.01     0.01           0.01       0.01    

P value adjustment method: bonf </code></pre>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>